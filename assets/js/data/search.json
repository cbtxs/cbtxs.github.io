[ { "title": "数学分析（级数收敛性判别法）", "url": "/posts/sequence_convergence/", "categories": "数学分析", "tags": "数学分析", "date": "2024-01-08 20:04:14 +0800", "snippet": "写在前面考研4年过去了，好多数学分析的知识都没有用到，已经忘完了，所以搞个文档回顾一下以前的知识，本文档记录一下所有的与级数有关的定理。数项级数的收敛性判断考虑数列 \\(a_n\\) 数项级数 \\(S_n = \\sum_{k=0}^n a_k\\) 的收敛性可以由 \\(a_n\\)的性质得出。首先是顶级炸弹：柯西收敛准则 柯西收敛准则: \\(S_n\\) 收敛的充要条件为 \\(\\forall \\epsilon &amp;gt; 0\\), 存在 \\(N\\)s.t. \\(\\forall m &amp;gt; N, p &amp;gt; 0\\)\\[|S_{m+p} - S_m| = |a_{m+1}+...+a_{m+p}| &amp;lt; \\epsilon\\] 下面是一些当 \\(a_n \\geq 0\\) 时使用的一些判别法： 比较判别法 当 \\(0 \\leq a_n \\leq b_n\\)，若 \\(\\sum b_n\\) 收敛，那么 \\(\\suma_n\\) 也收敛。 进阶比较判别法 当 \\(0 \\leq a_n \\leq b_n\\)，若 \\(\\lim_{n\\to\\infty}\\frac{a_n}{b_n} = l\\) 且 \\(0 &amp;lt; l &amp;lt; \\infty\\) 那么 \\(\\sum a_n\\) 也收敛。 比式判别法 当 \\(a_n \\geq 0\\)，若存在 \\(0 &amp;lt; q &amp;lt; 1,\\) 使得\\(\\frac{a_{n+1}}{a_n} &amp;lt; q\\) 或 \\(\\lim_{n\\to\\infty}\\frac{a_{n+1}}{a_n} &amp;lt; q\\) 那么\\(\\sum a_n\\) 收敛。 根式判别法 当 \\(a_n \\geq 0\\), 若存在 \\(0 &amp;lt; q &amp;lt; 1\\), 使得\\(\\sqrt[n]{a_n} &amp;lt; q\\) 或 \\(\\lim_{n\\to\\infty}\\sqrt[n]{a_{n}} &amp;lt; q\\) 那么\\(\\sum a_n\\) 收敛。 级数只是一堆不连续的数的求和，下面的判别法将其与函数结合起来，使得可以做一些巧妙的技巧 积分判别法 对于 \\([1, +\\infty)\\) 上的非负函数\\(f(x)\\)，\\(\\int_{1}^{+\\infty} f \\mathrm{d} x\\) 的敛散性与\\(\\sum_{n=1}^{+\\infty}f(n)\\) 相同。" }, { "title": "微分、变分和非线性问题", "url": "/posts/nonlinear-paralioc/", "categories": "偏微分方程数值解", "tags": "微分几何, 偏微分方程数值解, 有限元", "date": "2022-10-31 12:04:14 +0800", "snippet": "写在前面变分是一个非常强大的数学工具,在计算数学理论和算法设计中有很多应用.冯康院士借助变分原理奠定了有限元计算方法的严格数学理论,为后世有限元计算方法的实际应用提供了理论保证, 是近代中国数学的巨大创新.在笔者学习的过程中发现很多资料中只讲了变分的计算,没有说明计算出来的变分是什么?但是事实上变分就是无穷维Hilbert空间上的微分.所以本文从微分出发,讲一讲微分与变分之间的联系, 最后使用 FEALPy,基于变分求解一个非线性抛物方程.一、微分 定义: 设函数 \\(f\\) 为在 \\(x_0\\) 邻域有定义的函数, 若存在 \\(A \\in \\mathbb R\\), 使得\\[\\Delta f = f(x_0+\\Delta x) - f(x_0) = A \\Delta x + O(\\Delta x),\\] 则称 \\(f\\) 在 \\(x_0\\) 处可微, 微分为\\[\\mathrm df = A\\mathrm dx.\\]在梅加强版的数学分析中, 将 \\(x \\to Ax\\) 的线性映射称为 \\(f\\) 在 \\(x_0\\) 处的微分. 对于 \\(\\mathbb R^n\\) 上的函数 \\(f\\) 可以类似定义: 定义: 设函数 \\(f\\) 为在 \\(\\boldsymbol x_0 \\in \\mathbb R^n\\) 周围有定义的函数, 若存在 \\(A \\in \\mathbb R^n\\) , 使得\\[\\Delta f = f(\\boldsymbol x_0+\\Delta \\boldsymbol x) - f(\\boldsymbol x_0) = A \\cdot \\Delta \\boldsymbol x + O(|\\Delta \\boldsymbol x|),\\] 则称 \\(f\\) 在 \\(x_0\\) 处可微, 微分为\\[\\mathrm df = A\\cdot \\mathrm d\\boldsymbol x.\\]在梅加强版的数学分析中, 将 \\(\\boldsymbol x \\to A\\boldsymbol x\\) 的线性映射称为 \\(f\\) 在 \\(\\boldsymbol x_0\\) 处的微分. 注: 为什么要说微分 $\\mathrm{d}f$ 是一个线性映射呢? 这里引用[1]中的解释:首先看微分 \\(\\mathrm{d}f\\) 是做什么用的, \\(\\mathrm{d}f\\) 告诉你:“我是一个无穷小增量, 你要问增量是多大, 你得给我一个方向 (向量) ,我告诉你在这个方向上的增量是多少(实数) ”, 所以本身微分就是向量到实数的映射. 更多关于这个的讨论见[1]二、变分对于变分, 常见的定义是这样: 令 \\(f \\in C^1(\\Omega\\times\\mathbb R\\times\\mathbb R^{n})\\) , 定义如下泛函:\\[I(u) = \\int_{\\Omega} f(x, u(x), \\nabla u(x)) \\ \\mathrm dx.\\]\\(\\forall \\phi \\in C^1_0(\\Omega)\\), \\(I\\) 关于 \\(\\phi\\) 的变分为:\\[\\delta I(u_0, \\phi) = \\lim_{t \\to 0} \\frac{1}{t} (I(u_0+t\\phi) - I(u_0)).\\]这样的定义其实并不好, 因为它只告诉了我们变分如何计算, 但是计算出来的 “变分”是什么? 这个定义就无法回答. 要回答这个问题, 我们还是要回到微分的定义,从微分出发看变分应该是个什么.正如前面所说: 我们希望 \\(\\mathbb R\\) 上的函数 \\(f\\) 的微分存在, 就要存在一个 \\(A \\in \\mathbb{R}\\) , 使得\\[\\Delta f(x_0) = f(x_0+\\Delta x) - f(x_0) = A \\Delta x + O(\\Delta x).\\]类似的, 对于一个空间 \\(V\\) 上的泛函 \\(I\\) , 我们可以这样写:\\[\\Delta I(u_0) = I(u_0 + \\Delta u) - I(u_0) = A \\Delta u + O(\\Vert\\Delta u\\Vert_{V}).\\]那么问题来了, \\(A\\) 是什么? 是通常的函数么? 很显然不是, 因为 \\(I(u_0 + \\Delta u) - I(u_0)\\) 是实数, 那么 \\(A\\Delta u\\) 也应该是实数, 所以 \\(A\\)只能是一个泛函！而且与前面微分的对比, \\(A\\) 还要是一个线性泛函, 定义在 \\(V\\) 上.所以变分应该如下定义. 定义: 设 \\(I\\) 为Banach空间 \\(V\\) 上的一个泛函, 若能找到一个线性泛函 \\(A\\), 使得:\\[\\Delta I(u_0) = I(u_0 + \\Delta u) - I(u_0) = A \\Delta u + O(\\Vert\\Delta u\\Vert_{V}).\\] 对于任意的 \\(\\Delta u \\in V\\) 成立, 则称 \\(A\\) 是 \\(I\\) 在 \\(u_0\\) 处的变分, 记为 \\(I_{u_0}\\) .可以证明变分有以下性质:\\[I_{u_0}(v) = \\lim_{t \\to 0} \\frac{I(u_0 + tv) - I(u_0)}{t}, \\quad \\forall v \\in V.\\]\\(V\\) 上的泛函是 \\(V\\) 到 \\(\\mathbb R\\) 上的映射, 更进一步, 对于 \\(V\\) 到任意其他 Banach 空间 \\(U\\) 上的的映射也可以有类似的定义[2]. 定义: 设 \\(U, V\\) 是两个 Banach 空间, 对于一个算子 \\(F : U \\to V\\) 若存在一个线性算子\\(A: U \\to V\\) 满足: \\(\\forall \\epsilon &amp;gt; 0, \\exists \\delta &amp;gt; 0\\) 使得\\[\\Vert F(u) - F(u_0) - A(u - u_0)\\Vert_{V} \\leq \\epsilon \\Vert u-u_0\\Vert_{U}.\\] 对于任意的 \\(||u - u_0|| &amp;lt; \\delta\\) 成立, 则称 \\(A\\) 是 \\(F\\) 在 \\(u_0\\) 处的\\(\\mathrm{Fr\\&#39;echet}\\) 微分, 记为 $F_{u_0}$同样, \\(\\mathrm{Fr\\&#39;echet}\\) 微分也有以下性质:\\[F_{u_0}(v) = \\lim_{t \\to0} \\frac{F(u_0 + tv) - F(u_0)}{t}, \\quad \\forall v \\in U.\\]为了方便叙述, 将 \\(\\mathrm{Fr\\&#39;echet}\\) 微分与变分不加以区分,将 \\(\\mathrm{Fr\\&#39;echet}\\) 微分也当作变分.三、牛顿迭代算法变分应用非常广泛, 像求最速下降曲线方程, 测地线方程等, 很多资料中都有讲, 本文主要讲变分在计算数学中的一个应用: 非线性问题的线性化.考虑非线性问题:\\[\\mathcal L(u) = f.\\]任选初值 \\(u_0\\) , 记 \\(\\mathcal L\\) 在 \\(u_0\\) 处的变分为 \\(\\mathcal L_{u_0}\\) , 令 \\(\\delta u_0 = u - u_0\\) , 则有\\[\\mathcal L(u) = \\mathcal L(u_0+\\delta u_0) = \\mathcal L(u_0) + \\mathcal L_{u_0}(\\delta u_0) + O(\\Vert\\delta u_0\\Vert) = f,\\]舍去高阶项后得到一个以 \\(\\delta u_0\\) 为未知量的线性问题:\\[(1)\\quad \\quad \\mathcal L_{u_0}(\\delta u_0) = f - \\mathcal L(u_0).\\]令 \\(u_1 = u_0 + \\delta u_0\\) , 就得到一个 \\(u\\) 的逼近, \\(u_1\\) 代替 \\(u_0\\)重复上面的过程就可以得到一个 \\(u_2\\) ,以此类推就能得到一个函数列\\(\\{u_k\\}_{k=0}^{\\infty}\\) , 当 \\(\\mathcal{L}\\) 满足某些性质 (本文不再展开) 时就有\\(\\lim_{k \\to\\infty} u_k=u\\) , 这就是通过牛顿迭代求解非线性方程的过程.四、有限元求解非线性抛物方程现在我们使用上述的牛顿迭代法求解一个非线性抛物方程, 考虑问题:\\[\\begin{cases} u_t(\\boldsymbol x, t) = \\nabla \\cdot (a(u)\\nabla u) \\quad &amp;amp; t &amp;gt; 0, \\boldsymbol x \\in \\Omega\\\\u(\\boldsymbol x, t) = 0 &amp;amp; t &amp;gt; 0, \\boldsymbol x\\in \\partial \\Omega\\\\u(\\boldsymbol x, t) = u_0(\\boldsymbol x) &amp;amp; t = 0, \\boldsymbol x \\in \\Omega\\end{cases}\\]其中 \\(\\Omega = (0, 1)^2\\) 是空间区域, \\([0, T]\\) 是时间区域, \\(a\\) 是一个\\(H_0^1(\\Omega)\\to L^2(\\Omega)\\) 的算子, \\(a(u) = |\\nabla u|^{p-2}\\), \\(p\\neq 2\\) 是一个常整数, \\(u_0(\\boldsymbol x) = \\sin(\\pi x_0)\\sin(\\pi x_1)\\)(1) 时间离散首先时间区域离散, 将 \\([0, T]\\) 分成 \\(\\{t_0 = 0, t_1, t_2, …t_k = \\frac{kT}{N}, \\dots, t_N = T\\}\\), 记 \\(u^k = u(x, k)\\) , 得到离散方程:\\[u_t^n = \\nabla \\cdot (a(u^n)\\nabla u^n).\\]记 \\(\\tau = \\frac{T}{N}\\) , 将时间项使用向后欧拉离散, 得到离散格式的方程:\\[u^n -\\tau\\nabla \\cdot (a(u^n)\\nabla u^n) = u^{n-1}.\\]令\\(\\mathcal{L}(u) = u - \\tau\\nabla\\cdot(a(u)\\nabla u)\\)则 \\(\\mathcal{L}\\) 是 \\(H_0^1(\\Omega) \\to H_0^1(\\Omega)\\) 的算子, 问题重写为求解 \\(u^n\\in H_{0}^1(\\Omega)\\) 使其满足:\\[(2)\\quad \\quad \\mathcal{L}(u^n) = u^{n-1}.\\](2) 迭代求解假设已知第 \\(n-1\\) 层的函数 \\(u^{n-1}\\) , 要求解\\[\\mathcal L(u^n) = u^{n-1}.\\]这时有一个困难: \\(\\mathcal L\\) 是非线性的, 这里使用上一节讲的牛顿迭代算法,构造一个函数列 \\(\\{u_k^{n}\\}_{k=0}^{\\infty}\\) 来逼近 \\(u\\) . 令迭代初值为\\(u_0^n = u^{n-1}\\) , 牛顿迭代 \\((1)\\) 进行的关键是求解 \\(\\delta u_k \\inH_{0}^1(\\Omega), k = 1, 2,...\\) , 使其满足\\[(3)\\quad \\quad \\mathcal{L}_{u^{n}_k}(\\delta u_k) = u^{n-1}-\\mathcal L(u^n_k).\\]这是一个线性方程, 已经可以使用有限元方法求解了, 但是在此之前我们得先计算 \\(\\mathcal L\\) 的变分 \\(\\mathcal L_{u}\\) :\\[\\begin{aligned}\\mathcal L_{u}(\\delta u)&amp;amp; = \\lim_{t\\to0}\\frac{1}{t}(\\mathcal L(u+t\\delta u)-\\mathcal L(u))\\\\&amp;amp; = \\lim_{t\\to0}\\frac{1}{t}\\{u+t\\delta u-\\tau\\nabla\\cdot[a(u+t\\delta u)\\nabla(u+t\\delta u)] - u + \\tau\\nabla\\cdot(a(u)\\nabla u)\\}\\\\&amp;amp; = \\lim_{t\\to0}\\frac{1}{t}\\{t\\delta u -\\tau\\nabla\\cdot[a(u+t\\delta u)\\nabla (t \\delta u)]- \\tau\\nabla\\cdot[[a(u+t\\delta u)-a(u)]\\nabla u]\\}\\\\&amp;amp; = \\delta u-\\tau\\nabla\\cdot[a(u)\\nabla \\delta u] - \\tau\\nabla\\cdot\\big[\\lim_{t\\to0}\\frac{1}{t}[a(u+t\\delta u)-a(u)]\\nabla u\\big]\\\\ \\end{aligned}\\]其中 \\(\\lim_{t\\to0}\\frac{1}{t}[a(u+t\\delta u)-a(u)]\\) 是 \\(a\\) 在 \\(u\\) 处的变分作用于 \\(\\delta u\\) , 即 \\(a_u(\\delta u)\\) :\\[\\begin{aligned}a_{u}(\\delta u)&amp;amp; = \\lim_{t\\to0}\\frac{1}{t}[a(u+t\\delta u)-a(u)]\\\\ &amp;amp; = \\lim_{t\\to0}\\frac{1}{t}[|\\nabla (u+t\\delta u)|^{p-2}-|\\nabla u|^{p-2}]\\\\&amp;amp; = \\lim_{t\\to0} \\frac{1}{t}[(\\nabla u\\cdot\\nabla u+2t\\nabla u \\cdot \\nabla \\delta u + t^2\\nabla\\delta u\\cdot\\nabla \\delta u)^{ \\frac{p-2}{2}} - (\\nabla u\\cdot\\nabla u)^{ \\frac{p-2}{2}}]\\\\&amp;amp; = (p-2)(\\nabla u \\cdot \\nabla u)^{\\frac{p-4}{2}}\\nabla u \\cdot \\nabla \\delta{u}\\\\&amp;amp; = (p-2)|\\nabla u|^{p-4}\\nabla u \\cdot \\nabla \\delta{u}\\\\\\end{aligned}\\]所以:\\(\\mathcal L_u(\\delta u) = \\delta u-\\tau\\nabla\\cdot[a(u)\\nabla\\delta u]-\\tau\\nabla\\cdot(a_u(\\delta u)\\nabla u)\\).(3) 空间离散令等式 \\((3)\\) 两边乘以测试函数 \\(v \\in H_{0}^{1}(\\Omega)\\) :\\[\\int_{\\Omega} \\mathcal L_{u^n_k}(\\delta u_k) v \\ \\mathrm{d}x = \\int_{\\Omega} u^{n-1}v\\ \\mathrm{d}x-\\int_{\\Omega} \\mathcal L(u_k^n) v \\ \\mathrm dx ,\\]使用分部积分上式转化为:\\[\\begin{aligned}&amp;amp; \\int_{\\Omega}\\delta u_k\\ v \\ \\mathrm dx +\\tau \\int_{\\Omega}a(u^{n}_k)\\nabla \\delta u_k \\cdot \\nabla v \\ \\mathrm dx + \\tau\\int_{\\Omega}a_{u^n_k}(\\delta u_k)\\nabla u^n_k \\cdot \\nabla v \\ \\mathrm dx\\\\&amp;amp; = \\int_{\\Omega} u^{n-1}v \\ \\mathrm{d}x-\\int_{\\Omega}u_k^n v\\ \\mathrm dx-\\tau\\int_{\\Omega} \\mathcal a(u_k^n)\\nabla u_k^n \\cdot \\nabla v \\ \\mathrm dx.\\end{aligned}\\]那么线性问题 \\((3)\\) 转化为: 求解 \\(\\delta u_k \\in H_{0}^1(\\Omega)\\), \\(\\forall v \\in H_{0}^1(\\Omega)\\) , 满足上式.令 \\(\\mathcal T\\) 是 \\(\\Omega\\) 的一个网格剖分,\\(V^L(\\mathcal T)\\) 是 \\(\\mathcal T\\) 上的 Lagrange 有限元空间,那么对应的有限元问题为: 求解 \\(u_h \\in V^L_0(\\Omega)\\) , \\(\\forall v \\in V_0^L(\\Omega)\\) 满足:\\((4)\\quad \\quad \\begin{aligned}&amp;amp; \\int_{\\Omega} u_h\\ v \\ \\mathrm dx +\\tau \\int_{\\Omega}a(u^{n}_k)\\nabla u_h \\cdot \\nabla v \\ \\mathrm dx + \\tau\\int_{\\Omega}a_{u^n_k}(u_h)\\nabla u^n_k \\cdot \\nabla v \\ \\mathrm dx\\\\ &amp;amp; = \\int_{\\Omega} u^{n-1}v \\ \\mathrm{d}x-\\int_{\\Omega}u_k^n v\\ \\mathrm dx-\\tau\\int_{\\Omega} \\mathcal a(u_k^n)\\nabla u_k^n \\cdot \\nabla v \\ \\mathrm dx.\\end{aligned}\\)(4) 有限元求解记 \\(\\{\\phi_i\\}_{i=0}^{NS-1}\\) 是 \\(V_0^{L}(\\mathcal T)\\) 的基函数, 设\\[u_h = \\sum_{i=0}^{NS-1} U_i \\phi_i, \\ u_k^n = \\sum_{i=0}^{NS-1} U_{k, i}^n \\phi_i, \\ u^n = \\sum_{i=0}^{NS-1} U_i^n \\phi_i,\\]\\[M_{ij} = \\int_{\\Omega} \\phi_i\\phi_j \\ \\mathrm dx, \\ \\ S_{ij} = \\int_{\\Omega}a(u_k^n) \\nabla \\phi_i \\cdot \\nabla \\phi_j, \\ \\ B_{ij} = \\int_{\\Omega}a_{u^n_k}(\\phi_j)\\nabla u_k^n \\cdot \\nabla\\phi_i \\ \\mathrm dx.\\]则有限元问题 \\((4)\\) 转换为了代数方程:\\[AU = F,\\]其中: \\(A = M+\\tau S + \\tau B, \\quad F = MU^{n-1} - MU^{n}_k - \\tau SU_k^n\\)(5) 程序实现程序实现见https://github.com/weihuayi/fealpy/tree/master/example/NonLinearParabolic_example.py五、总结\\(\\mathbb R^n\\) 空间上函数的微分, 与函数空间上算子的变分, 不同的概念却有着深刻的联系,以至于原本应用于 \\(\\mathbb R^n\\) 上的牛顿迭代也可以处理函数空间上的非线性问题,这就是数学的魅力, 这种和谐统一, 这种一步步抽象后俯瞰问题本质的感觉正是数学最吸引我们的地方.六、参考文献 [1]梁灿彬, 周彬. 微分几何入门与广义相对论.上册.第2版[M]. 科学出版社, 2009. [2]\\(\\mathrm{Fr\\&#39;echet derivative}\\)" }, { "title": "有限元外微分(三)：同调代数", "url": "/posts/exterior_calculus_3/", "categories": "偏微分方程数值解", "tags": "微分几何, 偏微分方程数值解, 有限元", "date": "2022-08-07 17:04:14 +0800", "snippet": "写在前面本文讲有限元中涉及到的同调代数de Rham 复形de Rham 复形是一列空间和映射:\\[0 \\to \\Lambda^0(\\Omega) \\xrightarrow{ \\mathrm{d}} \\Lambda^1(\\Omega) \\xrightarrow{ \\mathrm{d}} \\cdots \\xrightarrow{ \\mathrm{d}} \\Lambda^n(\\Omega) \\to 0\\]因为 \\(\\mathrm{d}\\circ \\mathrm{d} = 0\\), 所以 \\(\\forall k \\in \\{0, 1, \\cdots, n\\}\\):\\[\\mathcal{R}( \\mathrm{d}: \\Lambda^{k-1}(\\Omega) \\to \\Lambda^k(\\Omega)) \\subset\\mathcal{N}( \\mathrm{d}: \\Lambda^{k}(\\Omega) \\to \\Lambda^{k+1}(\\Omega))\\]所以称这个函数空间和映射的序列为一个 上链复形. de Rham 上同调空间 \\(H_{dR}^k\\) 是零空间与像空间的商空间:\\[H_{dR}^k = \\frac{\\mathcal{N}(\\mathrm{d}: \\Lambda^{k}(\\Omega) \\to \\Lambda^{k+1}(\\Omega))}{\\mathcal{R}(\\mathrm{d}: \\Lambda^{k-1}(\\Omega) \\to \\Lambda^{k}(\\Omega))}\\]即: 当 \\(w_1, w_2 \\in \\mathcal{N}( \\mathrm{d}: \\Lambda^{k}(\\Omega) \\to \\Lambda^{k+1}(\\Omega))\\)且 \\(w_1-w_2 \\in \\mathcal{R}( \\mathrm{d}: \\Lambda^{k-1}(\\Omega) \\to \\Lambda^k(\\Omega))\\)则在 \\(H_{dR}^k\\) 中 \\(w_1 = w_2 = [w_1]\\). \\(H_{dR}^k\\) 的维数等于 \\(\\Omega\\)的 Betti 数上面讲的是光滑的 de Rham 复形, 那么类似地可以定义 \\(L^2\\) de Rham 复形:\\[0 \\to H\\Lambda^0(\\Omega) \\xrightarrow{ \\mathrm{d}} H\\Lambda^1(\\Omega) \\xrightarrow{ \\mathrm{d}} \\cdots \\xrightarrow{ \\mathrm{d}} H\\Lambda^n(\\Omega) \\to 0\\]那么 \\(H_{dR}^{k}\\) 同构于调和函数空间 \\(\\mathfrak{H}^k\\):\\[\\mathfrak{H}^{k}(\\Omega) = \\{\\omega \\in H\\Lambda^{k}(\\Omega)| \\mathrm{d}\\omega =0, \\langle\\omega, \\mathrm{d}\\eta\\rangle_{L^2\\Lambda^k} = 0\\ \\forall \\eta \\inH\\Lambda^{k-1}(\\Omega)\\}\\]事实上, \\(\\mathfrak{H}^{k}(\\Omega) = \\mathcal{N}( \\mathrm{d}: \\Lambda^{k}(\\Omega) \\to \\Lambda^{k+1}(\\Omega)) \\cap\\mathcal{R}^{\\perp}( \\mathrm{d}: \\Lambda^{k-1}(\\Omega) \\to \\Lambda^k(\\Omega))\\)所以这个同构关系很显然.当 \\(\\Omega\\) 是一个单连通区域, 所有的上同调空间都是 \\(0\\). 此时称复形:\\[0 \\to \\Lambda^0(\\Omega) \\xrightarrow{ \\mathrm{d}} \\Lambda^1(\\Omega) \\xrightarrow{ \\mathrm{d}} \\cdots \\xrightarrow{ \\mathrm{d}} \\Lambda^n(\\Omega) \\to 0\\]是恰当的余微分算子定义余微分算子: \\(\\delta: \\Lambda^k(\\Omega) \\to \\Lambda^{k-1}(\\Omega)\\):\\[\\star \\delta \\omega = (-1)^k \\mathrm d \\star \\omega, \\quad \\omega \\in\\Lambda^k(\\Omega)\\]则根据内积定义有:\\[\\langle \\mathrm{d}\\omega, \\eta \\rangle = \\langle \\omega, \\delta \\eta \\rangle + \\int_{\\partial\\Omega} \\mathrm{Tr} \\omega \\wedge \\mathrm{Tr} \\star \\eta, \\quad\\omega \\in \\Lambda^k(\\Omega), \\eta \\in \\Lambda^{k+1}(\\Omega)\\]当 \\(\\omega\\) 或 \\(\\eta\\) 的迹为 \\(0\\) 时,\\[\\langle \\mathrm{d}\\omega, \\eta \\rangle = \\langle \\omega, \\delta \\eta \\rangle\\]即, \\(\\delta\\) 是 \\(\\mathrm d\\) 的共轭算子. 类比与 \\(H\\Lambda^k\\), 可以定义:\\[H^*\\Lambda^k(\\Omega) = \\{\\omega \\in L^2\\Lambda^k(\\Omega)| \\delta \\omega \\inL^2\\Lambda^{k-1}(\\Omega)\\}\\]显然有: \\(H^*\\Lambda^k(\\Omega) = \\star H\\Lambda^{n-k}(\\Omega)\\), 且有对偶复形:\\[0 \\leftarrow H^*\\Lambda^0(\\Omega) \\xleftarrow{ \\delta} \\cdots \\xleftarrow{ \\delta} H^*\\Lambda^n(\\Omega) \\leftarrow 0\\]边界迹迹算子 \\(\\mathrm{Tr}: \\Lambda^k(\\Omega) \\to \\Lambda^k(\\partial \\Omega)\\)可以认为是 Sobolve 空间中 \\(H^1\\Lambda^k(\\Omega)\\) 到 \\(H^{1/2}\\Lambda^k(\\partial\\Omega)\\)的迹算子的扩展. 对于 \\(\\omega \\inH\\Lambda(\\Omega)\\) 其迹的意义如下:对于 \\(\\rho \\in H^{1/2}\\Lambda^k(\\partial\\Omega)\\), 用 \\(\\bar{\\star} \\rho\\) 表示 \\(\\rho\\) 关于边界 \\(\\partial \\Omega\\)的 Hodge star, 则必定存在一个 \\(\\eta \\in H^1\\Lambda^{n-k-1}(\\Omega)\\) 使得 \\(\\mathrm{Tr} \\eta = \\bar{\\star}\\eta\\), 且有:\\[||\\eta||_{H^1} \\leq c||\\bar{\\star}\\rho||_{H^{1/2}} \\leq c ||\\rho||_{H^{1/2}}\\]则对于任意的 \\(\\omega \\in \\Lambda^k(\\Omega)\\) 有:\\[\\begin{aligned}\\langle \\mathrm{Tr}\\omega, \\rho \\rangle &amp;amp; = \\int_{\\partial \\Omega}\\mathrm{Tr}\\omega \\wedge \\bar{\\star}\\rho\\\\&amp;amp; = \\int_{\\partial\\Omega}\\mathrm{Tr}\\omega \\wedge \\mathrm{Tr} \\eta\\\\&amp;amp; = \\int_{\\Omega} [ \\mathrm{d} \\omega \\wedge \\eta + (-1)^k\\omega \\wedge \\delta\\eta] \\\\&amp;amp; \\leq||\\omega||_{H\\Lambda}||\\eta||_{H^1}\\\\&amp;amp; \\leq||\\omega||_{H\\Lambda}||\\rho||_{H^{1/2}}\\end{aligned}\\]定义:\\[\\mathring{H}\\Lambda^k(\\Omega) = \\{\\omega \\in H\\Lambda^k(\\Omega)|\\mathrm{Tr}\\omega = 0\\}\\]若 \\(\\omega \\in H^*\\Lambda^k(\\Omega)\\), 则 \\(\\star\\omega \\in H\\Lambda^{n-k}(\\Omega)\\), 所以 \\(\\mathrm{Tr}\\) 有意义, 有:\\[\\mathring H^*\\Lambda^k(\\Omega) := \\star \\mathring H\\Lambda^{n-k}(\\Omega) = \\{\\omega \\in H^*\\Lambda^k(\\Omega)| \\mathrm{Tr} \\star\\omega = 0\\}\\]若 \\(\\omega\\) 光滑, 则 \\(\\mathrm{Tr}\\omega = 0\\) 当且仅当 \\(\\omega_x\\) 的切向分量为 \\(0\\); \\(\\mathrm{Tr}\\star\\omega = 0\\) 当且仅当 \\(\\omega_x\\) 的法向分量为 \\(0\\).有以下结论:\\[\\{\\omega \\in L^2\\Lambda^k(\\Omega) | \\langle \\omega, \\mathrm{d}\\eta\\rangle_{L^2\\Lambda^{k}(\\Omega)} = 0, \\ \\forall \\eta \\in H\\Lambda^{k-1}(\\Omega) \\}= \\{\\omega \\in \\mathring H^*\\Lambda^k(\\Omega) | \\delta \\omega = 0\\}\\]\\[\\{\\omega \\in L^2\\Lambda^k(\\Omega) | \\langle \\omega, \\delta \\eta\\rangle_{L^2\\Lambda^{k}(\\Omega)} = 0, \\ \\forall \\eta \\in H\\Lambda^{k+1}(\\Omega) \\}= \\{\\omega \\in \\mathring H\\Lambda^k(\\Omega) | \\mathrm{d} \\omega = 0\\}\\]且有:\\[\\mathfrak{H}^k = \\{\\omega \\in H\\Lambda^k(\\Omega) \\cap \\mathring H^*\\Lambda^k(\\Omega) | \\mathrm{d} \\omega = 0, \\delta \\omega =0\\}\\]以上三个结论需要证明带有边界条件的上同调用 \\(\\mathring \\Lambda^k(\\Omega)\\) 表示 \\(\\Lambda^k(\\Omega)\\)中带有紧支集的光滑 \\(k-\\)形式 组成的子空间. 因为推前算子和微分算子可交换, 所以\\(\\mathrm{Tr (d} \\omega) = \\mathrm{d (Tr}\\omega)\\), 所以 \\(\\mathrm{d} \\mathring \\Lambda^k(\\Omega) \\subset \\mathring \\Lambda^{k+1}(\\Omega)\\)有如下的 de Rham 复形:\\[0 \\to \\mathring \\Lambda^0(\\Omega) \\xrightarrow{ \\mathrm{d}}\\mathring \\Lambda^1(\\Omega) \\xrightarrow{ \\mathrm{d}} \\cdots \\xrightarrow{ \\mathrm{d}}\\mathring \\Lambda^n(\\Omega) \\to 0\\]因为在 \\(H\\Lambda^k(\\Omega)\\) 中 \\(\\mathring \\Lambda^k(\\Omega)\\) 的闭包为\\(\\mathring H\\Lambda^k(\\Omega)\\), 所以有以下复形:\\[0 \\to \\mathring H \\Lambda^0(\\Omega) \\xrightarrow{ \\mathrm{d}}\\mathring H \\Lambda^1(\\Omega) \\xrightarrow{ \\mathrm{d}} \\cdots \\xrightarrow{ \\mathrm{d}}\\mathring H \\Lambda^n(\\Omega) \\to 0\\]复形的上同调空间为:\\[\\mathfrak{ \\mathring H}^{k}(\\Omega) = \\{\\omega \\in \\mathring H\\Lambda^{k}(\\Omega)| \\mathrm{d}\\omega =0, \\langle\\omega, \\mathrm{d}\\eta\\rangle_{L^2\\Lambda^k} = 0\\ \\forall \\eta \\in\\mathring H\\Lambda^{k-1}(\\Omega)\\}\\]同理有:\\[\\{\\omega \\in L^2\\Lambda^k(\\Omega) | \\langle \\omega, \\mathrm{d}\\eta\\rangle_{L^2\\Lambda^{k}(\\Omega)} = 0, \\ \\forall \\eta \\in \\mathring H\\Lambda^{k-1}(\\Omega) \\}= \\{\\omega \\in H^*\\Lambda^k(\\Omega) | \\delta \\omega = 0\\}\\]\\[\\{\\omega \\in L^2\\Lambda^k(\\Omega) | \\langle \\omega, \\delta \\eta\\rangle_{L^2\\Lambda^{k}(\\Omega)} = 0, \\ \\forall \\eta \\in \\mathring H\\Lambda^{k+1}(\\Omega) \\}= \\{\\omega \\in H\\Lambda^k(\\Omega) | \\mathrm{d} \\omega = 0\\}\\]\\[\\mathring{\\mathfrak{H}}^k = \\{\\omega \\in \\mathring H\\Lambda^k(\\Omega) \\cap H^*\\Lambda^k(\\Omega) | \\mathrm{d} \\omega = 0, \\delta \\omega =0\\}\\]以上三个结论需要证明显然有: \\(\\mathring{\\mathfrak{H}}^{n-k}(\\Omega) = \\star \\mathfrak{H}^k(\\Omega)\\)同调代数同调代数将微分几何中的 \\(\\mathrm{de Rham}\\)上同调和代数拓扑中的单纯形同调结合起来，再很多种数学分支中都有应用.这里将会给出基本定义, 如上链映射, 上链投影和上链同伦.上链复形: 一个上链复形由一列向量空间(或者交换群)和一系列映射组成:\\[\\dots \\to V_{k-1} \\xrightarrow{d_{k-1}} V_k \\xrightarrow{d_{k}} V_{k+1} \\to\\dots\\]其中 \\({\\rm d}_{k+1}\\circ \\mathrm{d}_{k} = 0\\), 即称 \\(V = \\oplus V_{k}\\)和次数加 \\(1\\) 的映射 \\({\\rm d} : V \\to V\\), \\({\\rm d}_{k+1}\\circ \\mathrm{d}_{k} = 0\\) 为上链复形 \\((V, \\mathrm{d})\\) .注意: 在有限元分析中讨论的复形, 当 \\(k &amp;lt; 0\\) 或 \\(k\\) 足够大时, \\(V_k = 0\\).记 \\(\\mathcal{R}( \\mathrm{d}_k)\\) 为 \\(\\mathrm{d}_k\\) 的像空间, 称为k-coboundaries, \\(\\mathcal{N}(\\mathrm{d}_k)\\) 为 \\(\\mathrm{d}_k\\) 的零空间, 称为 k-cocycles. 商空间 \\(H^k(V) := \\mathcal{N}(\\mathrm{d}_k)/\\mathcal{R}( \\mathrm{d}_{k-1})\\) 是 \\(k\\) 次 上同调空间.给出两个上链 \\(V, V&#39;\\), 若一列映射 \\(f_k: V_k \\to V_k&#39;\\) 满足 \\(\\mathrm{d}_k&#39;f_k = f_{k+1} \\mathrm{d}_k\\) 则称其为 上链映射,对于一个上链映射 \\(f\\), \\(f_k\\) 会将 k-cocycles 映射为 k-cocycles, 将 k-coboundaries 映射为 k-coboundaries, 所以诱导了一个上同调空间间的映射: \\(H^k(f) : H^k(V) \\to H^k(V&#39;)\\)若 \\(V&#39;\\) 是 \\(V\\) 的子链(即 \\(V_k&#39; \\subset V_k\\)), 则恒同映射 \\(i : V&#39; \\to V\\)是一个上链映射, 同时诱导了一个上同调映射 \\(H^k(V&#39;) \\to H^k(V)\\)." }, { "title": "Green&#39;s function", "url": "/posts/greenfunction/", "categories": "偏微分方程数值解", "tags": "偏微分方程, 偏微分方程数值解", "date": "2022-06-21 11:02:14 +0800", "snippet": "Poisson 方程的格林函数考虑问题:\\[\\begin{cases} -\\Delta u = f \\quad \\text{in} \\ \\Omega\\\\ u = g \\quad \\text{on} \\ \\partial \\Omega\\end{cases}\\qquad \\qquad (1)\\]\\(\\Omega \\in \\mathbb R^3\\). 假设 \\(G(x)\\) 满足:\\[\\begin{cases} -\\Delta G = \\delta_0 \\quad \\text{in} \\ \\Omega\\\\ G = 0 \\quad \\text{on} \\ \\partial \\Omega\\end{cases}\\qquad \\qquad (2)\\]则有:\\[\\begin{aligned}u(x) &amp;amp; = \\int_{\\Omega} \\delta_x u(y) \\ \\mathrm dy\\\\&amp;amp; = -\\int_{\\Omega} \\Delta G(y-x) u(y) \\ \\mathrm dy\\\\&amp;amp; = \\int_{\\Omega} \\nabla G(y-x) \\nabla u(y) \\ \\mathrm dy - \\int_{\\partial \\Omega} u(y)\\nabla G(y-x) \\cdot \\boldsymbol n \\ \\mathrm dS\\\\&amp;amp; = \\int_{\\partial \\Omega} G(y-x) \\nabla u(y) \\cdot \\boldsymbol n -\\int_{\\Omega} \\Delta u(y) G(y-x) \\ \\mathrm dy\\\\&amp;amp; \\quad \\quad - \\int_{\\partial \\Omega} u(y)\\nabla G(y-x) \\cdot \\boldsymbol n \\ \\mathrm dS\\\\&amp;amp; = -\\int_{\\Omega} f(y)G(y-x) \\ \\mathrm dy - \\int_{\\partial \\Omega} g\\nablaG(y-x)\\cdot \\boldsymbol n \\ \\mathrm dS\\end{aligned}\\]所以只要我们能解出问题 (2) 中的 \\(G(y)\\) 那么对于任意的 \\(L^1\\) 函数 \\(f, g\\)都可以用上面的公式解决问题 (1), 其中 \\(G\\) 被称为是方程(1)的格林函数.特殊区域的格林函数 \\(R^3\\) 上的格林函数: 对问题 (2) 第一项左右同时傅里叶变换:\\[-\\hat{\\Delta G} = \\hat{\\delta_0} \\quad \\Rightarrow \\quad |\\boldsymbol{k|}^2 \\hat{G} = 1 \\quad \\Rightarrow \\hat{G} = \\frac{1}{|\\boldsymbol{k}|^2}\\] 所以:\\[\\begin{aligned} G(\\boldsymbol{x}) &amp;amp; = -\\frac{1}{(2\\pi)^3}\\int_{R^3} \\frac{1}{|\\boldsymbol{k}|^2} e^{i \\boldsymbol{k}\\cdot \\boldsymbol{x}} \\ \\mathrm d \\boldsymbol{k}\\\\ &amp;amp; = -\\frac{1}{(2\\pi)^3}\\int_{0}^{+\\infty} \\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\frac{1}{r^2} e^{i r\\cos(\\phi)| \\boldsymbol{x}|} r^2\\sin(\\phi) \\mathrm d \\phi \\mathrm d \\theta \\mathrm dr\\\\ &amp;amp;= -\\frac{1}{(2\\pi)^2} \\int_{0}^{+\\infty} \\left(\\int_{0}^{\\pi} e^{ir\\cos(\\phi)|x|} \\mathrm d\\cos(\\phi)\\right) \\mathrm dr\\\\ &amp;amp; = -\\frac{1}{2\\pi^2| \\boldsymbol{x}|} \\int_{0}^{+\\infty} \\frac{\\sin(r| \\boldsymbol{x}|)}{r} \\mathrm dr\\\\ &amp;amp; = -\\frac{1}{4\\pi | \\boldsymbol{x}|} \\end{aligned}\\] Helmholtz 方程的格林函数考虑问题:\\[\\begin{cases} \\Delta u + \\omega^2 u = f \\quad \\text{in} \\ \\Omega\\\\ u = g \\quad \\text{on} \\ \\partial \\Omega\\end{cases}\\qquad \\qquad (3)\\]\\(\\Omega \\in \\mathbb R^3\\). 假设 \\(G(x)\\) 满足:\\[\\begin{cases} \\Delta G + \\omega^2 G = \\delta_0 \\quad \\text{in} \\ \\Omega\\\\ G = 0 \\quad \\text{on} \\ \\partial \\Omega\\end{cases}\\qquad \\qquad (4)\\]称 \\(G\\) 是 方程(3) 的格林函数.特殊区域的格林函数 \\(R^3\\) 上的格林函数: 对问题 (2) 第一项左右同时傅里叶变换:\\[\\hat{\\Delta G} + \\omega^2 \\hat{G} = \\hat{\\delta_0} \\quad \\Rightarrow \\quad (\\omega^2-|\\boldsymbol{k|}^2) \\hat{G} = 1 \\quad \\Rightarrow \\hat{G} = \\frac{1}{\\omega^2-|\\boldsymbol{k}|^2}\\] 所以:\\[\\begin{aligned} G(\\boldsymbol{x}) &amp;amp; = \\frac{1}{(2\\pi)^3}\\int_{R^3} \\frac{1}{\\omega^2-|\\boldsymbol{k}|^2} e^{i \\boldsymbol{k}\\cdot \\boldsymbol{x}} \\ \\mathrm d \\boldsymbol{k}\\\\ &amp;amp; = \\frac{1}{(2\\pi)^3}\\int_{0}^{+\\infty} \\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\frac{1}{\\omega^2-r^2} e^{i r\\cos(\\phi)| \\boldsymbol{x}|} r^2\\sin(\\phi) \\mathrm d \\phi \\mathrm d \\theta \\mathrm dr\\\\ &amp;amp;= -\\frac{1}{2(2\\pi)^2} \\int_{0}^{+\\infty}\\left(\\frac{r}{\\omega+r} + \\frac{r}{r-\\omega}\\right) \\left(\\int_{0}^{\\pi} e^{ir\\cos(\\phi)|x|} \\mathrm d\\cos(\\phi)\\right) \\mathrm dr\\\\ &amp;amp; = -\\frac{1}{8\\pi^2| \\boldsymbol{x}|} \\int_{-\\infty}^{+\\infty} \\frac{\\sin(r| \\boldsymbol{x}|)}{\\omega + r} \\mathrm dr+ \\int_{-\\infty}^{+\\infty} \\frac{\\sin(r| \\boldsymbol{x}|)}{r - \\omega} \\mathrm dr\\\\ &amp;amp; = -\\frac{1}{4\\pi^2 | \\boldsymbol{x}|} \\int_{-\\infty}^{+\\infty} \\frac{\\sin(r| \\boldsymbol{x}|)\\cos(\\omega |\\boldsymbol{x}|)}{r} \\ \\mathrm dr\\\\ &amp;amp; = -\\frac{1}{4\\pi |\\boldsymbol{x}|}\\cos(\\omega| \\boldsymbol{x}|) \\end{aligned}\\] " }, { "title": "Cuthill-Mckee 算法", "url": "/posts/cuthill_mckee/", "categories": "高性能计算", "tags": "偏微分方程, 偏微分方程数值解, 编程, 高性能计算", "date": "2022-06-08 11:02:14 +0800", "snippet": "写在前面如何高效的求解矩阵方程是计算数学中的核心问题, 在大多数偏微分方程数值方法中, 需要计算的矩阵是稀疏矩阵. 稀疏矩阵有一个 带宽 的概念: 一个矩阵某一行的第一个非零元位置到最后一个非零元的距离称为这一行的带宽,矩阵最大行带宽就是矩阵的带宽. 为了能够快速求解, 一般希望矩阵的带宽越小越好. Cuthill-Mckee 算法就是一种降低矩阵带宽的算法.\\[\\begin{pmatrix} 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\\\ 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\\\ 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\\\ 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\\\ 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1\\\\ 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0\\\\ 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0\\\\ 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1\\\\\\end{pmatrix}\\]矩阵方程角度的降低带宽对于一个矩阵方程:\\[Ax = b\\]若 \\(P\\) 是一个循环矩阵则:\\[P^TAPP^Tx = P^T b\\]与原方程同解, 令 \\(B = P^TAP, y = P^Tx, c = P^T c\\), 则求解\\[By = c\\]后, 令 \\(x = Py\\) 则得到原方程的解. 而使用合适的循环矩阵 \\(P\\) 可以使 \\(B\\)的带宽小与 \\(A\\) 的带宽, 所以寻找合适的 \\(P\\) 就是降低带宽的关键.网格角度的降低带宽在有限元方法中, 组装的矩阵实际上是自由度的 邻接矩阵,如对于质量矩阵 \\(M\\), 只有当 2, 3 号自由度在同一个单元时, \\(M(2, 3)\\)才有可能不为 0, 不在一个单元时 \\(M(2, 3)\\) 一定为 0.\\[M = \\begin{pmatrix}\\frac{1}{12} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{24}\\\\\\frac{1}{24} &amp;amp; \\frac{1}{12} &amp;amp; \\frac{1}{12} &amp;amp; \\frac{1}{12}\\\\\\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{12} &amp;amp; 0\\\\\\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; 0 &amp;amp; \\frac{1}{12}\\\\\\end{pmatrix} \\quad M = \\begin{pmatrix}\\frac{1}{12} &amp;amp; 0 &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{24}\\\\0 &amp;amp; \\frac{1}{12} &amp;amp; \\frac{1}{12} &amp;amp; \\frac{1}{12}\\\\\\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{12} &amp;amp; \\frac{1}{24}\\\\\\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{24} &amp;amp; \\frac{1}{12}\\\\\\end{pmatrix}\\]那么显然, 矩阵 \\(A\\) 在第\\(k\\) 行的带宽就是与第 \\(k\\) 个自由度相邻的自由度中最大编号与最小编号之差. 前面的 \\(P^TAP\\) 实际上表示对自由度从新编号后的邻接矩阵.记自由度集合为 \\(\\mathcal D\\), 降低带宽问题等价于: 求一种自由度的编号规则,使自由度的邻接矩阵带宽讲到最低.Cuthill-Mckee 算法Cuthill-Mckee 算法就是一种根据邻接矩阵给自由度编号的算法, 算法如下:\\begin{algorithm} \\caption{Cuthill-Mckee} \\begin{algorithmic} \\INPUT 邻接矩阵 n2n \\OUTPUT 优化带宽的自由度顺序数组 order \\STATE 计算网格中所有点的度 degree. \\STATE 给最小度节点 v 编 0 号, 即 order[v] = 0. \\STATE 记有序集合 R = \\{v\\}, k = 1 \\WHILE{R $\\neq \\emptyset$} \\STATE 取 R 的头部元素, 记为 x. \\STATE 找到与 x 相邻且没有编号的点的集合 $S$. \\STATE 对 $S$ 中的点按度的大小从小到大的排序 \\FOR{y $\\in$ S} \\STATE 给 y 编号 k, 即 order[y] = k \\STATE 将 y 插入 R 的尾部. \\STATE k++ \\ENDFOR \\ENDWHILE \\END{ALGORITHMIC} \\END{ALGORITHM}Reverse-Cuthill-Mckee 算法Cuthill-Mckee 算法实际上就是选取了一个点 $v$, 然后距离他为 1 的点记为第一圈, 为2 的点记为第二圈的点, 第 $k$ 圈的点编号永远小于第 $k+1$ 圈的点的编号.所以只要每一圈的点个数越少, 那么带宽就越小.如下图:所以 Cuthill-Mckee 算法第一个点的选取会影响带宽的大小, 但是如果能找到一个点,使得距离他的 “圈数” 很多, 那么就变相的可以认为每圈的元素个数很少.下面是找到这样的点的算法:\\begin{algorithm} \\caption{Deepth} \\begin{algorithmic} \\INPUT 邻接矩阵 n2n, 节点 v \\OUTPUT 以 v 为起点的深度 d, 最长的树 T \\STATE 用 R 表示第 d 圈的节点, R = \\{v\\} \\STATE 记 v$&#39;$ = v, T = \\{v\\}, d = 1 \\WHILE{R $\\neq \\emptyset$} \\STATE 找到与 R 相邻的且没有计算与 v 的距离的点集 S \\STATE 找到一个 S 中与 v$&#39;$ 相连的点 v$&#39;&#39;$, 将 v$&#39;&#39;$ 放入 T \\STATE 更新数据 d++, v$&#39;$ = v$&#39;&#39;$, R = S \\ENDWHILE \\END{ALGORITHMIC} \\END{ALGORITHM}\\begin{algorithm} \\caption{Reverse-Cuthill-Mckee} \\begin{algorithmic} \\INPUT 邻接矩阵 n2n \\OUTPUT 优化带宽的自由度顺序数组 order \\STATE 任选一点 v. \\WHILE{True} \\STATE 使用 Deepth 算法计算 v 的深度 d0, 最长树 T. \\STATE 选择 T 中度最小的点 v$&#39;$, 使用 Deepth 算法计算其深度 d1, 最长树 T1. \\IF{d1 &amp;gt; d0} \\STATE v = v$&#39;$ \\ELSE \\STATE \\BREAK \\ENDIF \\ENDWHILE \\STATE 以 v 为起点使用 Cuthill-Mckee 算法 \\END{ALGORITHMIC} \\END{ALGORITHM}" }, { "title": "数学知识随记", "url": "/posts/math-essays/", "categories": "其他", "tags": "数学", "date": "2022-05-10 14:50:14 +0800", "snippet": "写在前面因为以前没有做笔记的习惯, 导致自己学了很多东西现在都忘记了,想要从新捡起来无从下手, 所以本文就记录一下平时学到的数学概念和知识,方便以后查阅.泛函分析 距离空间的完备化: 一个距离空间 \\((X, d)\\), 记:\\[\\mathcal E = \\{\\{x_n\\}_{n&amp;gt;0} \\subset X| \\{x_n\\}_{n&amp;gt;0}\\text{是} (X, d) \\text{中的 Cauchy 列}\\}\\] 定义 \\(\\mathcal E\\) 的等价关系 \\(\\sim : \\{x_n\\} \\sim \\{y_n\\}\\) 当且仅当\\[\\lim_{n\\to \\infty} d(\\{x_n\\}, \\{y_n\\}) = 0\\] 记 \\(\\bar X = \\mathcal E/\\sim\\), 距离定义为 \\(\\bar d\\):\\[\\bar d([\\{x_n\\}], [\\{y_n\\}]) = \\lim_{n\\to \\infty} d(x_n, y_n)\\] 则 \\((\\bar X, \\bar d)\\) 是一个完备空间, 在映射\\[\\begin{aligned} \\Phi: X &amp;amp; \\to \\bar X\\\\ x &amp;amp; \\to \\{x_n = x\\}_{n&amp;gt;0} \\end{aligned}\\] 的意义下, \\((X, d)\\) 等距嵌入于 \\((\\bar X, \\bar d)\\), \\((\\bar X, \\bar d)\\) 是 \\((X, d)\\) 的完备化. " }, { "title": "有限元外微分(二)：流形上的外微分", "url": "/posts/exterior_calculus_2/", "categories": "偏微分方程数值解", "tags": "微分几何, 偏微分方程数值解, 有限元", "date": "2022-05-04 22:31:14 +0800", "snippet": "写在前面在有限元外微分(一)中讲了基本的外代数的知识, 主要是在线性空间上的操作, 本文讲的是在一个微分流形上, 每个点上都有一个切空间,这个切空间上就可以定义外代数, 由此可以定义这个流形上的外微分.流形一个 \\(n\\) 维的光滑流形可以认为就是局部是 \\(\\mathbb R^n\\) 的拓扑空间,流形上每一点有一个切空间, 流形 \\(\\Omega\\) 上一点 \\(x\\) 处的切空间记为\\(T_x\\Omega\\), 用一个元组 \\((x, v)\\) 表示 \\(\\Omega\\) 上的一个切丛, 其中 \\(x \\in \\Omega, v \\in T_x\\Omega\\), \\(\\Omega\\) 上所有的切丛组成一个新的流形, 维数为 \\(2n\\), 事实上, 切丛就是向量场.对于两个流形 \\(\\Omega, \\Omega&#39;\\), 若 \\(\\phi : \\Omega \\to \\Omega&#39;\\)是一个光滑映射, 那么定义切映射 \\(D\\phi_x\\) 是 \\(T_x\\Omega\\) 到\\(T_{\\phi(x)}\\Omega&#39;\\) 的映射. 当 \\(\\Omega&#39; = \\R\\), \\(\\phi\\) 就是 \\(\\Omega\\) 上的标量函数, 用 \\(\\partial_v \\phi(x)\\) 表示 \\(D\\phi_x(v)\\). 当 \\(\\Omega = \\R\\), \\(\\phi\\) 是 \\(\\Omega\\) 上的一条曲线. 用 \\(\\frac{d\\phi(t)}{dt}\\) 表示 \\(D\\phi_t(1)\\).这里是一个流形的作用: 流形的角度看待泛函的变分微分形式类似于切丛的概念, 可以定义外形式丛: \\((x, \\mu)\\), 其中 \\(x\\in \\Omega, \\mu\\in \\mathrm{Alt}^k T_x\\Omega\\). 一个微分 \\(k\\) 形式就是一种外形式丛, 即:\\(\\omega = (x, \\omega_x)\\) 是一个微分 \\(k\\) 形式, 当对于任意的光滑矢量场 \\(\\{v_i\\}_{i=0}^{k-1}\\), 映射\\[x \\to \\omega_x(v_0(x), \\cdots, v_{k-1}(x))\\]是无穷光滑的.即光滑的外形式丛就是微分 \\(k\\) 形式, 简记为 \\(k\\) 形式, 这里用\\(\\Lambda^k(\\Omega)\\) 表示 \\(\\Omega\\) 上所有的微分 \\(k\\) 形式组成的空间, 特别的,\\(\\Lambda^0(\\Omega) = C^{\\infty}(\\Omega)\\), \\(\\Lambda^1(\\Omega)\\)是所有的光滑余切向量场.外积令 \\(\\Lambda(\\Omega) = \\oplus_k\\Lambda^k(\\Omega)\\), 逐点定义外积\\[(\\omega \\wedge \\eta)_x = \\omega_x \\wedge \\eta_x\\]\\(C^m\\) 光滑的微分形式现在考虑没有那么光滑的微分形式, 对于一个外形式丛 \\(\\omega = (x, \\omega_x)\\), 若映射\\[x \\to \\omega_x(v_0(x), \\cdots, v_{k-1}(x))\\]对于任意光滑向量场 \\(\\{v_i\\}_{i=0}^{k-1}\\) 属于 \\(C^m(\\Omega)\\) 即是 \\(m\\) 次光滑的, 则称 \\(\\omega\\) 是一个 \\(C^m\\) 微分 \\(k\\) 形式,其组成的空间记为 \\(C^m\\Lambda^k(\\Omega)\\).微分形式的积分微分 \\(1\\) 形式可以在线上积分, 微分 \\(2\\) 形式可以在面上积分, 微分 \\(3\\)形式可以在体上积分.外微分外微分算子 \\(\\mathrm{d}: \\Lambda^{k}(\\Omega) \\to \\Lambda^{k+1}(\\Omega)\\) 是一个线性微分算子, 当 \\(\\Omega\\) 是 \\(\\R^n\\) 中的区域, \\(T_x\\Omega\\) 是 \\(\\R^n\\), 取 \\(\\omega \\in \\Lambda^k(\\Omega)\\)则对于任意的光滑向量场 \\(\\{v_i\\}_{i=0}^{k-1}\\), 定义:\\[\\mathrm{d}\\omega(v_0, v_1, \\dots, v_{k}) = \\sum_{j=0}^{k}(-1)^{j}\\partial_{v_j} \\omega_x(v_0, \\dots, \\hat v_{j}, \\dots, v_{k})\\]其中 \\(\\hat{v}_j\\) 表示没有这一项. 因为映射\\[x \\to \\omega_x(v_0, \\dots, v_{k-1})\\]是光滑的, 所以上面的定义是 well define 的. 这样定义的微分算子 \\(\\mathrm{d}\\) 有以下两个性质: \\[\\mathrm{d} \\circ \\mathrm{d} = 0\\] \\[\\mathrm{d}(\\omega\\wedge\\eta) = \\mathrm{d}\\omega\\wedge\\eta + (-1)^j \\omega\\wedge \\mathrm{d}\\eta, \\quad \\forall \\omega \\in \\Lambda^j(\\Omega), \\eta \\in \\Lambda^k(\\Omega)\\] 这里推导一下当 \\(\\{\\partial_{x_i}\\}_{i=0}^{n-1}|_x\\) 是 \\(T_x\\Omega\\)上的标准正交基时外微分的形式: 记 \\(\\{ \\mathrm{d}{x_i}\\}_{i=0}^{n-1}\\) 是一形式的基, 满足:\\[\\mathrm{d}x_i(\\partial_{x_j}) = \\delta_{ij}\\]则有:\\[\\mathrm{d}x_0\\wedge \\mathrm{d}x_1\\wedge\\cdots\\wedge\\mathrm{d}x_{k-1}(\\partial_{x_{\\sigma(0)}}, \\partial_{x_{\\sigma(1)}}, \\dots, \\partial_{x_{\\sigma(k-1)}}) = \\begin{cases} \\mathrm{sign}(\\sigma) &amp;amp; \\quad \\sigma &amp;lt; k\\\\ \\quad 0 &amp;amp; \\quad \\mathrm{other} \\end{cases}\\]若 \\(\\omega = a \\mathrm{d}x_0\\wedge \\mathrm{d}x_1\\wedge\\cdots\\wedge\\mathrm{d}x_{k-1}\\), 则:\\[\\mathrm{d}\\omega(\\partial_{x_0}, \\partial_{x_1}, \\dots, \\partial_{x_{k-1}},\\partial_{x_m}) = (-1)^{k}(\\partial_m a)\\]所以:\\[\\begin{aligned}\\mathrm{d}\\omega &amp;amp; = (-1)^k \\partial_m a\\ \\mathrm{d}x_0\\wedge \\mathrm{d}x_1\\wedge\\cdots\\wedge\\mathrm{d}x_{k-1} \\wedge \\mathrm dx_m\\\\&amp;amp; = \\mathrm{d}a \\wedge\\mathrm{d}x_0\\wedge \\mathrm{d}x_1\\wedge\\cdots\\wedge\\mathrm{d}x_{k-1}\\end{aligned}\\]拉回映射对于光滑映射 \\(\\phi: \\Omega \\to \\Omega&#39;\\), 可以定义拉回映射 \\(\\phi^*\\), 将\\(\\Lambda^k(\\Omega&#39;)\\) 映射到 \\(\\Lambda^k(\\Omega)\\): 满足:\\[(\\phi^*\\omega)_x(v_0, \\dots, v_{k-1}) = \\omega_{\\phi(x)}(D\\phi_x(v_1), \\dots,D\\phi(v_{k-1}))\\]拉回映射有如下性质: 保外积: \\(\\phi^*(\\omega\\wedge\\eta) = \\phi^*\\omega \\wedge \\phi^*\\eta\\) 保微分: \\(\\phi^*( \\mathrm{d}\\omega) = \\mathrm{d}(\\phi^*\\omega)\\) 保积分: 当 \\(\\phi\\) 是一个保定向的微分同胚, 则有: \\(\\int_{\\Omega}\\phi^* \\omega = \\int_{\\Omega&#39;} \\omega, \\omega \\in \\Lambda^k(\\Omega&#39;)\\)当 \\(\\Omega&#39;\\) 是 \\(\\Omega\\) 的子流形, 那么包含映射 \\(i : \\Omega&#39; \\to \\Omega\\)的拉回映射写作 \\(\\mathrm{Tr}_{\\Omega, \\Omega&#39;} : \\Lambda(\\Omega) \\to\\Lambda(\\Omega&#39;)\\), 当 \\(\\Omega&#39; = \\partial \\Omega\\), \\(\\mathrm{Tr}_{\\Omega, \\partial\\Omega}\\) 简写为 \\(\\mathrm{Tr}\\).现在我们来从微分几何的角度看待数学分析中的第一类曲面积分第二类曲面积分记 \\(\\Omega\\) 是一个 3 维区域, \\(\\partial\\Omega\\) 上的面元是 \\(\\mathrm{d}S\\), 记 \\(\\mathrm{d}n = \\star( \\mathrm{d}S)\\) 是一个 \\(1-\\) 形式, 显然 \\(n\\) 就是 \\(\\partial \\Omega\\) 的外法向, \\(\\mathrm{d}S\\) 满足:\\(\\star(\\mathrm{d}S\\wedge \\mathrm{d}n) = 1\\), 若一个 \\(2-\\) 形式 \\(\\omega = f_0 \\mathrm{d}y \\wedge \\mathrm{d}z + f_1 \\mathrm{d}z \\wedge \\mathrm{d}x + f_2 \\mathrm{d}x\\wedge \\mathrm{d}y\\), 在数学分析中有:\\[\\int_{\\partial \\Omega} (f_0, f_1, f_2) \\cdot \\boldsymbol{n} \\mathrm{d}S = \\int_{\\partial \\Omega} f_0 \\mathrm{d}y \\mathrm{d}z + f_1 \\mathrm{d}z \\mathrm{d}x + f_2 \\mathrm{d}x \\mathrm{d}y\\]事实上有:\\[\\int_{\\partial \\Omega} (f_0, f_1, f_2) \\cdot \\boldsymbol{n} \\mathrm{d}S = \\int_{\\partial \\Omega} \\star\\omega(n) \\mathrm{d}S\\]\\[\\int_{\\partial \\Omega} f_0 \\mathrm{d}y \\mathrm{d}z + f_1 \\mathrm{d}z \\mathrm{d}x + f_2 \\mathrm{d}x \\mathrm{d}y = \\int_{\\partial \\Omega} \\omega\\]因为 \\(\\Lambda^2 \\partial\\Omega\\) 的基只有一个, 就是 \\(\\mathrm{d}S\\), 所以 \\(\\mathrm{Tr}\\omega = k \\mathrm{d}S\\), 记 \\(v_1, v_2\\) 是 \\(\\partial \\Omega\\)上的单位正交切向量场, 满足 \\(\\mathrm{d}S(v_1, v_2) = 1\\), 则 \\(v_1, v_2, n\\)组成了 \\(\\Omega\\) 上的单位正交切向量场, 则有:\\[\\star\\omega(n) = \\omega(v_1, v_2) = \\mathrm{Tr} \\omega(v_1, v_2) = k\\mathrm{d}S(v_1, v_2) = k\\]\\[\\mathrm{Tr}\\omega = \\star\\omega(n) \\mathrm{d}S\\]所以第一类曲线积分曲面积分之间的关系就是一个 \\(2-\\) 形式的积分和这个 \\(2-\\) 形式的迹的积分:\\[\\int_{\\partial \\Omega} \\omega = \\int_{\\partial \\Omega} \\mathrm{Tr}\\omega\\]Stokes 定理\\[\\int_{\\Omega} \\mathrm{d}\\omega = \\int_{\\partial \\Omega} \\mathrm{Tr}\\omega, \\quad \\forall\\ \\omega \\in \\Lambda^{n-1}\\Omega\\]结合莱布尼茨定理, 若 \\(\\omega \\in \\Lambda^k\\Omega, \\ \\eta \\in \\Lambda^{n-k-1}\\Omega\\):\\[\\int_{\\Omega} \\mathrm{d}\\omega \\wedge \\eta = (-1)^{k-1}\\int_{\\Omega} \\omega \\wedge \\mathrm{d}\\eta + \\int_{\\partial\\Omega} \\mathrm{Tr}\\omega\\wedge \\mathrm{Tr}\\eta\\]Interior product\\[(\\omega\\lrcorner v)_x = \\omega_x \\lrcorner v_x\\]内积对于两个 \\(k-\\) 形式 \\(\\omega, \\eta\\) 定义其内积:\\[\\langle \\omega, \\eta \\rangle_{L^2\\Lambda^k} = \\int_{\\Omega} \\langle\\omega_x, \\eta_x \\rangle \\mathrm{vol} = \\int_{\\Omega} \\omega \\wedge \\star\\eta\\]在这个内积下, \\(\\Lambda^{k}\\Omega\\) 中的一部分元素定义了一个 Hilbert 空间\\(L^2\\Lambda^k\\Omega\\).Sobolev 空间的微分形式现在考虑没有那么光滑的微分形式, 对于一个外形式丛 \\(\\omega = (x, \\omega_x)\\), 若映射\\[x \\to \\omega_x(v_0(x), \\cdots, v_{k-1}(x))\\]对于任意光滑向量场 \\(\\{v_i\\}_{i=0}^{k-1}\\) 属于 \\(H^m(\\Omega)\\), 则称 \\(\\omega\\) 是一个 \\(H^m\\) 微分 \\(k\\) 形式,其组成的空间记为 \\(H^m\\Lambda^k(\\Omega)\\).现在定义另一个 Hilbert 空间:\\[H\\Lambda^k(\\Omega) := \\{\\omega \\in L^2\\Lambda^k(\\Omega)| \\mathrm{d}\\omega\\in L^2\\Lambda^{k+1}(\\Omega)\\}\\]其范数定义为:\\[||\\omega||_{H\\Lambda^k}^2 = ||\\omega||_{L^2\\Lambda^k}^2 + || \\mathrm{d}\\omega||_{L^2\\Lambda^{k+1}}\\]其中 \\(H\\Lambda^0(\\Omega)\\) 对应于 \\(H^1\\Lambda^0(\\Omega)\\), \\(H\\Lambda^{n}(\\Omega)\\) 对应于 \\(L^2\\Lambda^n(\\Omega)\\)" }, { "title": "不等式(一)：基本不等式", "url": "/posts/inequality_1/", "categories": "偏微分方程数值解", "tags": "偏微分方程, 偏微分方程数值解", "date": "2022-04-29 20:30:52 +0800", "snippet": "写在前面不等式在偏微分方程数值解的误差分析中有至关重要的作用, 本文记录常用的一些不等式,其中都是 evins 的《偏微分方程》这本书中的不等式.常用不等式 Cauchy 不等式\\[ab \\leq \\frac{a^2}{2} + \\frac{b^2}{2} \\quad (a, b \\in \\R)\\] 证明: \\(\\ a^2+b^2 -2ab \\geq 0\\) Young 不等式: 若 \\(1 &amp;lt; p, q &amp;lt; +\\infty\\), \\(\\frac{1}{p} + \\frac{1}{q}=1\\),则:\\[ab \\leq \\frac{a^p}{p} + \\frac{b^q}{q} \\quad (a, b &amp;gt; 0)\\] 证明: 映射 \\(x \\to e^x\\) 是凸的, 即:\\[e^{\\lambda a + (1-\\lambda)b} \\leq \\lambda e^a + (1-\\lambda)e^b\\] 所以:\\[ab = e^{ \\frac{1}{p}\\ln a^p + \\frac{1}{q}\\ln b^q} \\leq \\frac{e^{\\ln a^p}}{p} + \\frac{e^{\\ln b^q}}{q} = \\frac{a^p}{p} + \\frac{b^q}{q}\\] Holder 不等式(积分形式): 若 \\(1 &amp;lt; p, q &amp;lt; +\\infty\\), \\(\\frac{1}{p} + \\frac{1}{q}=1\\),\\(u \\in L^p(U), v \\in L^q(U)\\), 则:\\[\\int_{U} |uv| \\ \\mathrm dx \\leq ||u||_{L^p(U)} ||v||_{L^q(U)}\\] 证明: 令 \\(\\hat u = \\frac{u}{ \\lVert u \\rVert_{L^p(U)}}, \\hat v =\\frac{v}{ \\lVert v \\rVert_{L^q(U)}}\\), 则 \\(\\lVert \\hat u \\rVert_{L^p(U)} =1, \\lVert \\hat v \\rVert_{L^q(U)} = 1\\), 所以:\\[\\begin{aligned}\\int_{U} |uv| \\ \\mathrm dx &amp;amp; = \\lVert u \\rVert_{L^p(U)} \\lVert v \\rVert_{L^q(U)} \\int_{U}|\\hat u\\hat v| \\ \\mathrm dx\\\\ &amp;amp; \\leq \\lVert u \\rVert_{L^p(U)} \\lVert v \\rVert_{L^q(U)} \\left(\\frac{1}{p}\\int_{U} |\\hat u|^p \\mathrm dx + \\frac{1}{q} \\int_{U} |\\hat v|^{q}\\mathrm dx\\right)\\\\&amp;amp; = \\lVert u \\rVert_{L^p(U)} \\lVert v \\rVert_{L^q(U)}\\end{aligned}\\] Holder 不等式(离散形式):\\[|\\sum_{k=1}^n a_k b_k| \\leq \\left(\\sum_{k=1}^n |a_k|^p\\right)^{ \\frac{1}{p}} \\left(\\sum_{k=1}^n |b_k|^q\\right)^{ \\frac{1}{q}}\\] 证明： 略. 一般的 Hodler 不等式： 若 \\(1 &amp;lt; p_1, \\cdots, p_n &amp;lt; +\\infty\\), \\(\\frac{1}{p_1} + \\cdots + \\frac{1}{p_n}=1\\), \\(u_i \\in L^{p_i}(U)\\), 则\\[\\int_{U} |u_1 u_2 \\cdots u_n| \\ \\mathrm dx \\leq \\prod_{i=1}^n||u_i||_{L^{p_i}(U)}\\] 证明： 略. Minkowski 不等式: 若 \\(1 \\leq p &amp;lt; \\infty\\), \\(u, v \\in L^p(U)\\), 则:\\[\\lVert u+v \\rVert_{L^p(U)} \\leq \\lVert u \\rVert_{L^p(U)} + \\lVert v\\rVert_{L^p(U)}\\] 证明:\\[\\begin{aligned} \\lVert u+v \\rVert_{L^p(U)}^p &amp;amp; = \\int_{U}|u+v|^p \\ \\mathrm dx \\\\ &amp;amp; \\leq \\int_{U}|u+v|^{p-1}(|u|+|v|)\\ \\mathrm dx\\\\ &amp;amp; = \\int_{U}|u+v|^{p-1}|u|\\ \\mathrm dx + \\int_{U}|u+v|^{p-1}|v|\\ \\mathrm dx\\\\ &amp;amp; \\leq \\left(\\int_{U} |u+v|^p \\ \\mathrm dx \\right)^{ \\frac{p-1}{p}} \\left( \\left(\\int_{U} |u|^p \\ \\mathrm dx\\right)^{ \\frac{1}{p}} + \\left(\\int_{U} |v|^p \\ \\mathrm dx\\right)^{ \\frac{1}{p}} \\right)\\\\ &amp;amp; = \\lVert u+v \\rVert_{L^p(U)}^{p-1} \\left(\\lVert u \\rVert_{L^p(U)}+ \\lVert v \\rVert_{L^p(U)}\\right)\\end{aligned}\\] Minkowski 不等式(离散形式):\\[\\left(\\sum_{k=1}^n |a_k + b_k|^p\\right)^{\\frac{1}{p}} \\leq \\left(\\sum_{k=1}^n |a_k|^p\\right)^{\\frac{1}{p}} + \\left(\\sum_{k=1}^n |b_k|^p\\right)^{\\frac{1}{p}}\\] 证明： 略. \\(L^p\\) 范数的插值不等式 若 \\(1 \\leq s \\leq r \\leq t \\leq +\\infty, \\ u \\in L^s(U) \\cap L^t(U)\\), 且:\\[\\frac{1}{r} = \\frac{\\theta}{s} + \\frac{(1-\\theta)}{t}\\] 那么有:\\[\\lVert u \\rVert_{L^r(U)} \\leq \\lVert u \\rVert_{L^s(U)}^\\theta \\lVert u \\rVert_{L^t(U)}^{1-\\theta}\\] 证明: 令 \\(g = |u|^r, p = \\frac{s}{\\theta r}, q = \\frac{t}{(1-\\theta) r}\\), 则 \\(\\frac{1}{p} + \\frac{1}{q} = 1\\):\\[\\begin{aligned} \\|u\\|_{L^r(u)}^r = \\int_{U} |g| \\ \\mathrm dx &amp;amp; \\leq \\int_{U} |g|^{\\theta} |g|^{1-\\theta} \\ \\mathrm dx\\\\ &amp;amp; \\leq \\left(\\int_{U} |g|^{\\theta p}\\ \\mathrm dx \\right)^{\\frac{1}{p}} \\left(\\int_{U} |g|^{(1-\\theta) q}\\ \\mathrm dx \\right)^{\\frac{1}{q}}\\\\ &amp;amp; = \\left(\\int_{U} |u|^{s}\\ \\mathrm dx \\right)^{\\frac{\\theta r}{s} } \\left(\\int_{U} |u|^{t}\\ \\mathrm dx \\right)^{\\frac{(1-\\theta)r}{t}}\\\\ &amp;amp; = \\lVert u \\rVert_{L^s(U)}^{\\theta r} \\lVert u \\rVert_{L^t(U)}^{(1-\\theta) r}\\end{aligned}\\] Gronwall 不等式(微分形式): 若 \\(\\eta(t)\\) 在 \\([0, T]\\) 上非负且绝对连续,\\(\\phi, \\psi\\) 在 \\([0, T]\\) 上非负可积, 且在 \\([0, T]\\) 上几乎处处有:\\[\\eta&#39;(t) \\leq \\phi(t)\\eta(t) + \\psi(t)\\] 则\\[\\eta(t) \\leq e^{\\int_0^t \\phi(s) \\ \\mathrm ds}\\left(\\eta(0) + \\int_0^t \\psi(s) \\ \\mathrm ds\\right)\\] 证明:\\[\\frac{d}{ds} \\left(\\eta(s) e^{-\\int_0^s \\phi(r) \\ \\mathrm dr}\\right)= (\\eta&#39;(s) - \\eta(s) \\phi(s)) e^{-\\int_0^s \\phi(r) \\ \\mathrm dr}\\leq \\psi(s) e^{-\\int_0^s \\phi(r) \\ \\mathrm dr} \\leq \\psi(s)\\] 上式子几乎处处成立, 左右两边在 \\([0, t]\\) 作积分有:\\[\\eta(t) e^{-\\int_0^t \\phi(r) \\ \\mathrm dr} \\leq \\eta(0) + \\int_0^t \\psi(t) \\ \\mathrm dt\\] 证明结束. 注意: 当 \\(\\psi = 0, \\eta(0) = 0\\), 则 \\(\\eta == 0\\) Gronwall 不等式((积分形式): 若 \\(u(t)\\) 是 \\([0, T]\\) 上一个非负可积函数, 几乎处处满足:\\[u(t) \\leq C_1 \\int_0^t u(s) \\ \\mathrm ds + C_2\\] 则:\\[u(t) \\leq C_2(1 + C_1 t e^{C_1 t})\\] 证明: 令 \\(\\eta(t) = \\int_0^t u(s) \\ \\mathrm ds\\), 则可以用微分形式的Gronwall 不等式证明. 偏微分方程中的不等式 \\(\\mathrm{Poincar\\&#39;e}\\) 不等式: 令 \\(U\\) 是一个 \\(R^n\\) 中的有界连通开集,边界 \\(C^1\\) 光滑, 那么存在只与 \\(n, U\\) 有关的常数 \\(C\\), 使得:\\[||u - (u)_U||_{L^2(U)} \\leq C||Du||_{L^2(U)}\\] 其中 \\((u)_U = \\frac{1}{\\|U\\|}\\int_{U} u \\mathrm dx\\). \\(\\mathrm{Poincar\\&#39;e}\\) 不等式: 令 \\(U\\) 是一个 \\(R^n\\) 中的有界连通开集,边界 \\(C^1\\) 光滑, 若 \\(u \\in H^1_0(U)\\) 那么存在只与 \\(n, U\\) 有关的常数 \\(C\\), 使得:\\[||u||_{L^2(U)} \\leq C||Du||_{L^2(U)}\\] " }, { "title": "傅里叶变换", "url": "/posts/fourier_transform/", "categories": "偏微分方程数值解", "tags": "偏微分方程数值解, 数值分析", "date": "2022-04-09 22:02:14 +0800", "snippet": "写在前面最近学习傅里叶谱方法, 需要用到傅里叶变换, 故学习一下. 傅里叶变换, 傅里叶级数,离散傅里叶变换, 有三个不同的 傅里叶, 他们的关系是: 若函数定义域是有限区间 \\([a, b]\\), 那么可以认为函数是周期为 \\(b-a\\) 的周期函数, 可以展开成傅里叶级数; 当函数的定义域是 \\(\\mathbb R\\), 那么函数可以认为是周期为正无穷的周期函数, 这时傅里叶级数变成了积分形式, 这个函数到傅里叶系数的变换称为傅里叶变换 对于有限周期的函数, 当我们只取傅里叶级数展开的 \\((-N, N)\\) 部分, 那么此时我们有了一个这个函数的逼近, 那么函数再固定点处的值可以由这 \\(2N\\) 个基函数的值线性表出, 固定点处的值到表出系数的变换称为时离散傅里叶变换.简介根据傅里叶级数的知识可知: 若函数 \\(u \\in L^1(0, l), \\omega = \\frac{2\\pi}{l}\\),则存在 \\(\\{c_n\\}_{n=-\\infty}^{+\\infty} \\in \\mathbb C\\) 使得:\\[u(x) = \\sum_{n = -\\infty}^{+\\infty} c_n e^{\\omega i nx}\\]其中 \\(c_n\\) 被称为 \\(u(x)\\) 的傅里叶系数:\\[c_n = \\frac{1}{l} \\int_0^l u(x)e^{-\\omega inx}\\ \\mathrm dx\\]可以验证 \\(\\{e^{\\omega i nx}\\}_{n = -\\infty}^{+\\infty}\\) 线性无关且相互\\(L^2\\) 正交:\\[\\int_0^l e^{\\omega i n_0x} e^{\\omega i n_1x} \\ \\mathrm dx = \\delta_{n_0 n_1}\\]所以 \\(\\{e^{\\omega i nx}\\}_{n = -\\infty}^{+\\infty}\\) 可以认为是线性空间 \\(L^1(0, l)\\) 的基函数(因为 \\(L^1(0, l)\\) 上的任意函数都能用这组函数线性表出). 这组基函数有无穷多个,现在我们选取有限个基函数 \\(\\{e^{\\omega i nx}\\}_{n = -N}^{N-1}\\) 张成的空间来逼近 \\(L^1(0, l)\\)\\[u(x) \\approx \\sum_{n = -N}^{N-1} c_n e^{\\omega i nx}, \\quad u(x) \\in L^1(0, l)\\]可以证明:\\[\\lim_{N \\to \\infty} \\sum_{n = -N}^{N-1} c_n e^{\\omega i nx} = u(x), \\quad \\forallu(x) \\in L^1(0, l)\\]且在 \\(L^2\\) 范数下这个收敛速度是指数收敛.离散傅里叶变换作 \\([0, l]\\) 的剖分\\[P_N = \\{x_0 = 0, x_1 = \\frac{l}{2N}, \\cdots, x_k = k\\frac{l}{2N}, \\cdots, x_{2N} = l\\}\\]记 \\(u_j = u(x_j), j = 0, 1, \\cdots, 2N-1\\), 根据前面的讨论我们有如下的近似:\\[u_j \\approx \\sum_{n = -N}^{N-1} c_n e^{\\omega \\mathrm in x_j} = \\sum_{n=0}^{2N-1} c_n e^{\\omega \\mathrm inx_j}\\]其中第二个等式的原因为:\\[e^{\\omega \\mathrm i 2N x_j} = e^{\\mathrm i(2\\pi j)}=1, \\quad e^{\\omega \\mathrm i nx_j} = e^{\\omega \\mathrm i (n+2N)x_j}\\]令 \\(\\boldsymbol u = [u_0, \\cdots, u_{2N-1}]^T, \\boldsymbol E = (e^{\\omega ijx_k})_{jk}\\), 显然 \\(\\boldsymbol E\\) 非奇异,所以存在向量 \\(\\boldsymbol{\\hat u} = [\\hat u_0, \\hat u_1 \\cdots, \\hat u_{N-1}, \\hat u_{-N}, \\hat u_{-N+1}, \\cdots, \\hat u_{-1}]\\) 使得:\\[(2N)^{-1}\\boldsymbol{E\\hat u = u}\\]其中 \\(\\boldsymbol{\\hat u}\\) 可以看作是 \\(2N[c_0, c_1 \\cdots, c_{N-1}, c_{-N}, c_{-N+1}, \\cdots, c_{-1}]\\) 的近似.所以\\[u(x) \\approx (2N)^{-1}\\sum_{n = -N}^{N-1} \\hat u_n e^{\\omega \\mathrm in x}\\]y右端称为是 \\(u\\) 的傅里叶插值. 已知 \\(\\boldsymbol u\\) 求解 \\(\\boldsymbol {\\hat u}\\) 需要知道 \\(\\boldsymbol E^{-1}\\),而离散傅里叶变换非常优美的地方就在于: \\(\\boldsymbol E^{-1}\\) 是已知的!\\[\\boldsymbol E^{-1} = (2N)^{-1}(e^{-\\omega \\mathrm ijx_k})_{jk}\\]快速傅里叶变换众所周知, 虽然 \\(E^{-1}\\) 是已知的, 但是其计算复杂度为 \\(O(N^2)\\), 上世纪 60年代出现了快速傅里叶变换 \\(\\mathrm{fft}\\) 将从 \\(\\boldsymbol u\\) 到 \\(\\boldsymbol {\\hat u}\\) 的计算复杂度降到 \\(O(N\\cdot logN)\\)在 python 语言的 scipy 库中已实现 \\(\\mathrm{fft}\\) 算法, 下图为 \\(\\mathrm{fft}\\) 算法实现傅里叶插值. 对 Runge 函数 \\(f(x) = \\frac{1}{(x-5)^2+1}\\)作傅里叶插值： N = 4 N = 8 对函数\\(f(x) = \\frac{(3+x)^2\\sin(20x)\\cos^2(x)}{(x+1)^2}\\)作傅里叶插值： N = 64 N = 128 import scipy.fft as fftimport numpy as npimport matplotlib.pyplot as pltimport sysdef ff(x): &quot;&quot;&quot;@ @brief R -&amp;gt; R &quot;&quot;&quot; return (3+x)**2*np.sin(x*20)*np.cos(x)**2/(x+1)**2#插值基函数def basis(x, N, l): &quot;&quot;&quot; @brief 插值基函数以 N = 4 为例, 基函数的排列方式为 [0, 1, 2, 3, -4, -3, -2, -1] &quot;&quot;&quot; x = x[:, None]@(np.r_[np.arange(N), -np.arange(1, N+1)[::-1]][None, :]) om = 2*np.pi/l val = np.exp(om*1j*x) return val#插值函数def fourier_interpolation(f, l, N): &quot;&quot;&quot; @brief 计算函数 $f$ 在格点处的值, 经过快速傅里叶变换 fft 得到其傅里叶系数的近似 @param f : 被插值的函数 @param l : 定义域为 [0, l] @param N : 基函数的个数 2N &quot;&quot;&quot; x = np.linspace(0, l, 2*N, endpoint=False) fval = f(x) hfval = fft.fft(fval) #hfval = dft(x, fval) def fourier_function(x): bval = basis(x, N, l) return bval@hfval/(2*N) return fourier_functiondef dft(x, fval): &quot;&quot;&quot; @param dft 算法 &quot;&quot;&quot; x = x[:, None]@(np.r_[np.arange(N), -np.arange(1, N+1)[::-1]][None, :]) om = 2*np.pi/l val = np.exp(-om*1j*x).T@fval return vall = 2*np.piN = int(sys.argv[1])g = fourier_interpolation(ff, l, N)X = np.linspace(0, l, 10000)ffval = ff(X)gval = g(X)plt.grid(ls=&#39;--&#39;)plt.plot(X, ffval, c = &#39;r&#39;)plt.plot(X, gval, &#39;b&#39;)plt.legend([&#39;u&#39;, &#39;u_interpolation&#39;])" }, { "title": "有限元外微分(一)：外代数与外微分", "url": "/posts/exterior_calculus_1/", "categories": "偏微分方程数值解", "tags": "微分几何, 偏微分方程数值解, 有限元", "date": "2022-04-01 20:42:14 +0800", "snippet": "写在前面有限元外微分使用微分几何, 代数拓扑和同调代数等工具, 是一种用于理解和设计有限元离散方式的理论.简介有限元方法是构建一个解的子空间, 找子空间上最适合方程的解.有限元方法可以方便的讨论数值解与真解之间的误差, 其中误差包含三部分: 逼近误差: 度量数值解与真解之间的误差. 连续性误差: 有些问题需要解具有一定的连续性, 需要度量连续性. 稳定性误差: 度量设计的方法是否合适.其中逼近误差和连续性误差容易解决, 但是稳定性误差却不好消除.连续问题的可逼近性、一致性和适定性并不意味着稳定性PDE 问题的适定性反映了这个问题的几何, 代数, 拓扑, 同调结构, 由外微分, 同调代数,Hodge 理论形式化.交替代数令 \\(V\\) 是一个 \\(n\\) 维实向量空间, 用 \\(\\mathrm{Alt}^{k} V\\)表示所有 \\(V\\times V\\cdots\\times V \\to \\R\\) 上的线性映射, 将其中的元素称为 \\(V\\) 上的代数 \\(k\\) 形式. 特别的有: \\(\\mathrm{Alt}^0 V = \\R, \\mathrm{Alt}^1 V = V^*\\).外积给定 \\(\\omega \\in \\mathrm{Alt}^i V, \\eta \\in \\mathrm{Alt}^j K\\), 定义其外积为:\\(\\omega\\wedge \\eta \\in \\mathrm{Alt}^{i+j}V\\):\\[\\omega\\wedge\\eta(v_1, v_2, \\cdots, v_{i+j}) = \\sum_{\\sigma}\\mathrm{sign}(\\sigma) \\omega(v_{\\sigma(1)}, \\cdots, v_{\\sigma(i)})\\eta(v_{\\sigma(i+1)}, \\cdots, v_{\\sigma(i+j)}))\\]其中 \\(\\sigma\\) 取遍所有 \\((1, 2, ..., i+j)\\) 的全排列, 且满足 \\(\\sigma(1) &amp;lt;\\cdots&amp;lt; \\sigma(i), \\sigma(i+1) &amp;lt; \\cdots&amp;lt; \\sigma(i+j)\\).外积是双线性的, 且满足 反交换条件:\\[\\omega \\wedge \\eta = (-1)^{ij}\\eta \\wedge \\omega, \\quad \\omega \\in\\mathrm{Alt}^iV, \\eta \\in \\mathrm{Alt}^jV\\]记 \\(\\mathrm{Alt} V = \\oplus_{k} \\mathrm{Alt}^k V\\), 其在外积下组成一个代数称为Grassmann 代数 或 \\(V^*\\) 的外代数.拉回映射若 \\(L : V \\to W\\) 是一个线性映射, 则由 \\(L\\) 可以诱导一个映射 \\(L^* : \\mathrm{Alt} W \\to \\mathrm{Alt} V\\):\\[L^*\\omega(v_1, v_2, \\cdots, v_k) = \\omega (Lv_1, Lv_2, \\cdots, Lv_k) \\quad \\forall \\omega \\in \\mathrm{Alt}^k W, \\ v_1, v_2, \\cdots, v_k \\in V\\]\\(L^*\\) 称为 \\(L\\) 的拉回映射, 意为将 \\(W\\) 上的 \\(k\\) 形式拉回 \\(V\\) 上.拉回映射有传导性: 若 \\(U \\xrightarrow{K} V \\xrightarrow{L} W\\), 则 \\(\\mathrm{Alt} W \\xrightarrow{L^*} \\mathrm{Alt} V \\xrightarrow{K^*} \\mathrm{Alt} W\\). 且有: 拉回的复合等于复合的拉回, 外积的拉回等于拉回的外积:\\[K^* \\circ L^* = (L\\circ K)^*, \\quad L^*(\\omega\\wedge\\eta) = L^* \\omega \\wedge L^* \\eta\\]特殊地, 当 \\(V \\subset W\\), \\(W\\) 上定义了度量, 则存在一个恒同映射 \\(i : V \\to W\\), 正交投影映射 \\(\\pi : W \\to V\\), 即 \\(W \\xrightarrow{\\pi} V \\xrightarrow{i} W\\), 则有 \\(\\mathrm{Alt} W \\xrightarrow{i^*} \\mathrm{Alt} V \\xrightarrow{\\pi^*} \\mathrm{Alt} U\\). \\(k\\) 形式 \\(\\omega \\in \\mathrm{Alt}W\\) 对于空间 \\(V\\) 的切向分量为\\[(\\pi^*i^* \\omega)(v_1, v_2, \\cdots, v_k) = \\omega(\\pi v_1, \\pi v_2, \\cdots, \\piv_k)\\]法向分量为 \\(\\omega - \\pi^*i^* \\omega\\).基若 \\(v_0, v_1, \\cdots, v_{n-1}\\) 是 \\(V\\) 的一组基, 定义递增序列集合\\[A_n^k = \\{\\sigma : \\{0, 1, \\cdots, k-1\\} \\to \\{0, 1, \\cdots, n-1\\}, \\ \\sigma(i) \\leq \\sigma(i+1)\\}\\]则代数 \\(k\\) 形式 \\(\\omega\\) 可被\\(\\{\\omega(v_{\\sigma(0)}, v_{\\sigma(1)}, \\cdots, v_{\\sigma(k-1)}), \\sigma \\in A_{n}^k\\}\\)唯一确定.根据 \\(V\\) 的基可以定义 \\(V^*\\) 的基 \\(\\{\\mu_i\\}_{i=0}^{k-1}\\), 满足:\\[\\mu_i(v_j) = \\delta_{ij}\\]和 \\(\\mathrm{Alt}^{k}V\\) 的基\\(\\{\\mu_{\\sigma(0)} \\wedge \\cdots \\wedge \\mu_{\\sigma(k-1)}\\}_{\\sigma \\in A_n^k}\\):\\[\\mu_{\\sigma(0)} \\wedge \\cdots \\wedge \\mu_{\\sigma(k-1)}(v_{\\rho(0)}, \\cdots, v_{\\rho(k-1)}) = \\begin{cases} 1, \\quad \\sigma = \\rho\\\\ 0, \\quad \\mathrm{otherwise}\\end{cases}\\]interior product对于一个 \\(k\\) 形式 \\(\\omega\\) 和向量 \\(v \\in V\\), 定义一个 \\(k-1\\) 形式\\(\\omega \\lrcorner v\\):\\[\\omega \\lrcorner v(v_0, \\cdots, v_{k-2}) = \\omega(v, v_0, v_1, \\cdots, v_{k-2})\\]这个映射被称为 \\(\\mathrm{interior\\ product}\\),注意这不是内积 显然有:\\[(\\omega\\lrcorner v)\\lrcorner v = 0, \\quad \\omega \\in \\mathrm{Alt}^{k} V\\]\\[(\\omega \\wedge \\eta)\\lrcorner v = (\\omega \\lrcorner v)\\wedge \\eta + (-1)^k \\omega \\wedge (\\eta \\lrcorner v), \\quad \\omega \\in \\mathrm{Alt}^{k} V , \\ \\eta \\in \\mathrm{Alt}^l V\\]内积, 定向, 体元若 \\(V\\) 上定义了内积 \\((\\cdot, \\cdot)\\), 那么可以自然的定义 \\(\\mathrm{Alt}^kV\\) 上的内积: \\(\\langle\\cdot, \\cdot \\rangle\\)\\[\\langle \\omega, \\eta \\rangle = \\sum_{\\sigma \\in A_n^k} \\omega(v_{\\sigma(1)}, \\cdots, v_{\\sigma(k)})\\eta(v_{\\sigma(1)}, \\cdots, v_{\\sigma(k)}) \\quad \\omega, \\eta \\in \\mathrm{Alt}^kV\\]其中 \\(\\{v_i\\}_{i=0}^{n-1} \\subset V\\), 是 \\((\\cdot, \\cdot)\\) 下 \\(V\\) 的标准正交基.\\(\\mathrm{Alt}^nV\\) 维数为 1. 选择 \\(V\\) 上的一组有序的标准正交基 \\(\\{v_i\\}_{i=0}^{n-1}\\) 作为正的定向, 在这组正交基上的值为 1 的 \\(n\\) 形式被称为体元.双向量\\(w, v \\in V\\) 定义\\(v \\wedge w = v \\otimes w - w\\otimes v \\in V \\wedge V\\)是一个双向量. 若 \\(\\{v_i\\}_{i=0}^{n-1}\\) 是 \\(V\\) 的一组基, 则 \\(\\{v_{i}\\wedge v_{j}\\}_{0 \\leq i &amp;lt; j \\leq n-1}\\)是 \\(V\\wedge V\\) 的一组基. 所以 \\(\\dim(V\\wedge V) = \\frac{1}{2}n(n-1)\\).定义一个线性映射:\\[\\begin{aligned} \\mathrm{skw} : V\\otimes V &amp;amp; \\to V\\wedge V\\\\ v \\otimes w &amp;amp; \\to (v\\wedge w)/2\\end{aligned}\\]Hodge star 算子假设 \\(V\\) 是一个有定向的内积空间, 体元是 \\(\\mathrm{vol}\\), 对于 \\(\\omega\\in \\mathrm{Alt}^k V\\) 可以定义一个线性映射:\\[\\begin{aligned} L_{\\omega} : \\mathrm{Alt}^{n-k} &amp;amp; \\to R\\\\ \\mu &amp;amp; \\to \\omega \\wedge \\mu\\end{aligned}\\]其中 \\(\\omega \\wedge \\mu \\in \\mathrm{Alt}^n V\\), 上面的映射是在同构映射\\(c\\ \\mathrm{vol} \\to c\\) 的意义下.所以 \\(L_{\\omega} \\in (\\mathrm{Alt}^{n-k}V)^*\\), 根据里斯表示定理, 存在 \\(\\star \\omega \\in \\mathrm{Alt}^{n-k} V\\), 使得\\[L_{\\omega} (\\mu) = \\langle \\star \\omega, \\mu \\rangle\\]其中 \\(\\omega \\to \\star \\omega\\) 被称为是 Hodge star 算子.若 \\(\\{v_i\\}_{i=0}^{n-1}\\) 是 \\(V\\) 的正定向的正交基, 则有:\\[\\omega(e_{\\sigma(0)}, \\cdots, e_{\\sigma(k-1)}) = (\\mathrm{sign} \\ \\sigma) \\star \\omega(e_{\\sigma(k)}, \\cdots, e_{\\sigma(n-1)})\\]Hodge star 算子的另一个性质是:\\[\\star (\\star \\omega) = (-1)^{k(n-k)} \\omega, \\omega \\in \\mathrm{Alt}^k V\\]令 \\(W\\) 是 \\(V\\) 的一个子空间, 则 \\(\\omega\\) 可以分解为 \\(\\omega =\\omega_{\\perp} + \\omega_{\\parallel}\\) 其中 \\(\\omega_{\\perp}\\) 和 \\(\\omega_\\parallel\\) 分别是 \\(\\omega\\) 的相对 \\(W\\) 的法向部分和切向部分. 则有:\\[(\\star\\omega)_{\\perp} = \\star(\\omega_{\\parallel}), \\quad (\\star\\omega)_{\\parallel} = \\star(\\omega_{\\perp})\\]" }, { "title": "连续介质力学(二)：变形几何与运动学", "url": "/posts/continuum_mechanics_2/", "categories": "连续介质力学", "tags": "连续介质力学, 微分几何, 张量分析", "date": "2022-03-28 15:02:30 +0800", "snippet": "写在前面连续介质力学将物理上材料的变形问题转变为两个区域间的映射问题, 变形前后的张量被拉回推前, 使得复杂的物理问题可以用数学的方法解决.参考构型与当前构型一个材料在空间中占据的区域记为 \\(\\Omega\\), 经过一段时间 \\(t\\) 后变成另一块区域\\(\\Omega&#39;\\), 记 \\(\\Omega\\) 为参考构型, \\(\\Omega&#39;\\) 为当前构型. 那么存在一个映射\\(\\boldsymbol\\phi\\), 将 \\(\\Omega\\) 中的点 \\(p\\) 映射为 \\(p\\) 经过时间 \\(t\\) 后的位置 \\(\\boldsymbol\\phi(p)\\), 使用笛卡尔坐标系表示(Lagrange视角)即为:\\[\\boldsymbol x = \\boldsymbol\\phi(\\boldsymbol X, t)\\]其中 \\(\\boldsymbol X\\) 是 \\(p\\) 的坐标, \\(\\boldsymbol x\\) 是 \\(\\boldsymbol\\phi(p)\\) 的坐标. 引入变形梯度张量:\\[\\boldsymbol F = \\frac{\\partial x_i}{\\partial X_j} \\boldsymbol e_i \\otimes \\boldsymbol e_j = F_{ij}\\ \\boldsymbol e_i \\otimes \\boldsymbol e_j\\]则有:\\[\\mathrm{d} \\boldsymbol x = \\boldsymbol F \\mathrm d \\boldsymbol X\\]令 \\(J = \\mathrm{det}(F_{ij})\\), 表于当前构型与参考构型的体积比,因为体积不会边的无穷大也不会变成 0, 所以 \\(0 &amp;lt; J &amp;lt; \\infty\\), 同时 \\(J \\neq 0\\)也是解存在唯一的条件." }, { "title": "偏微分方程数值解编程", "url": "/posts/partial_diff_eq_programming/", "categories": "偏微分方程数值解", "tags": "偏微分方程, 偏微分方程数值解, 编程", "date": "2022-03-17 11:02:14 +0800", "snippet": "写在前面有很多学偏微分方程数值解的同学, 理论学的很好, 算法收敛性, 稳定性会证明,就是不能把算法编出来, 不会编程的一个原因是没有一门熟悉的编程语言,另一个很重要的原因是拿到一个算法, 不知道该怎么下手. 这篇文章的目的就是要解决这个问题, 希望大家读完这篇文章会有所收获.二元一次方程首先来看一个初中就学过的鸡兔同笼问题: 有若干只鸡兔同在一个笼子里, 从上面数, 有35个头, 从下面数, 有94只脚. 问笼中各有多少只鸡和兔?这个问题的未知量是鸡的个数和兔的个数, 分别设为 \\(x, y\\), 那么就可以列出下面方程:\\[\\begin{cases}x + y = 35\\\\2x + 4y = 94\\end{cases}\\]使用初中知识就可很快解决, 现在尝试让电脑来解决这个问题, 使用线代知识可以把这个方程写成矩阵形式:\\[\\boldsymbol A \\boldsymbol X = \\boldsymbol b\\]其中\\[\\boldsymbol A = \\begin{pmatrix}1 &amp;amp; 1\\\\2 &amp;amp; 4\\end{pmatrix}, \\quad\\boldsymbol X = \\begin{pmatrix}x \\\\y \\end{pmatrix}, \\quad\\boldsymbol b = \\begin{pmatrix}35 \\\\94 \\end{pmatrix}\\]把 \\(\\boldsymbol A\\) 和 \\(\\boldsymbol b\\) 输入进电脑, 调用求解器就可以计算出\\(x, y\\). 这看似简单的流程其实包含了大部分的偏微分方程数值解的步骤.五点差分方法下面用五点差分求解如下的 Poisson 方程\\[\\begin{cases}-\\Delta u = f \\quad in\\ \\Omega\\\\\\quad \\ \\ \\ u = 0 \\quad on\\ \\partial \\Omega\\end{cases}\\]其中 \\(f = sin(x)sin(y),\\ \\Omega = [0, \\pi]\\times[0, \\pi]\\).将 \\(\\Omega\\) 离散为以下网格:现在按上面求解二元一次方程的方法编写五点差分程序求解这个 Poisson 方程.首先第一步, 我们的未知量是什么? 是网格中每个节点处的值, 用 \\(u_{ij}\\)表示第 \\(i\\) 列, 第 \\(j\\) 行的节点 \\((x_i, y_j)\\) 处 \\(u\\) 的函数值.使用五点差分格式离散 \\(\\Delta u\\)\\[\\begin{align*}\\Delta u(x_i, y_j) &amp;amp; = u_{xx}(x_i, y_j) + u_{yy}(x_i, y_j) \\\\ &amp;amp; \\approx\\frac{u_{i+1, j}+u_{i-1, j}-2u_{i,j}}{h_0^2}+ \\frac{u_{i, j+1}+u_{i, j-1}-2u_{i,j}}{h_1^2}\\end{align*}\\]其中 \\(h_0, \\ h_1\\) 是 \\(x, \\ y\\) 方向的步长.有了这个结果我们就可以列方程了:\\[\\begin{cases}\\frac{u_{i+1, j}+u_{i-1, j}-2u_{i,j}}{h_0^2}+ \\frac{u_{i, j+1}+u_{i, j-1}-2u_{i,j}}{h_1^2}= f(x_i, y_j) \\quad (x_i, y_j) \\in \\Omega\\\\u(x_i, y_j) = 0 \\quad (x_i, y_j) \\in \\partial \\Omega\\end{cases}\\]其中第一个类型的方程有 9 个, 第二个方程的个数有 25 - 9 = 16 个,现在把他写成矩阵形式:\\[AX = b\\]这个时候, 很多人会觉得这个式子中最先获得的是 \\(A\\), 但事实上, 我们最先做的应该是确定 \\(X, b\\), 只有把未知量 \\(X\\) 和右端项 \\(b\\) 的顺序确定才能确定出 \\(A\\).确定 \\(X\\):\\[X = \\begin{pmatrix}u_{0,0}\\\\u_{0,1}\\\\\\vdots\\\\u_{1,0}\\\\u_{1,1}\\\\\\vdots\\\\u_{4,4}\\end{pmatrix}, \\quadb = \\begin{pmatrix}f_{0,0}\\\\f_{0,1}\\\\\\vdots\\\\f_{1,0}\\\\f_{1,1}\\\\\\vdots\\\\f_{4,4}\\end{pmatrix}\\]即:\\[X_i = u_{i \\% 5, i/5}, b_i = f_{i\\%5, i/5}\\]重写方程:\\[\\begin{cases}\\frac{1}{h_0^2}X_{i*5+5+j} + \\frac{1}{h_0^2}X_{i*5 - 5 + j} - 2(\\frac{1}{h_0^2} + \\frac{1}{h_1^2})X_{i*5 + j} + \\frac{1}{h_1^2}X_{i*5+j+1} + \\frac{1}{h_0^2}X_{i*5 + j-1} = b_{i*5+j}, \\quad 0 &amp;lt; i, j &amp;lt; 4\\\\X_{i*5+j} = 0. \\quad i, j \\in \\{0, 4\\}\\end{cases}\\]\\(i = i*5+j\\) 即:\\[\\begin{cases}\\frac{1}{h_0^2}X_{i+5} + \\frac{1}{h_0^2}X_{i - 5} - 2(\\frac{1}{h_0^2} + \\frac{1}{h_1^2})X_{i} + \\frac{1}{h_1^2}X_{i+1} + \\frac{1}{h_0^2}X_{i-1} = b_{i}, \\quad 0 &amp;lt; i \\% 5, i/5 &amp;lt; 4\\\\X_{i} = 0. \\quad i\\%5, i/5 \\in \\{0, 4\\}\\end{cases}\\]所以 矩阵 \\(A: (25, 25)\\): 若 \\(0 &amp;lt; i \\% 5, i/5 &amp;lt; 4 :\\)\\[A_{i, j} = \\begin{cases}\\frac{1}{h_0^2}, \\quad j = i+5 \\ or\\ j = i-5\\\\\\frac{1}{h_1^2}, \\quad j = i-1 \\ or\\ j = i+1\\\\- 2(\\frac{1}{h_0^2} + \\frac{1}{h_1^2}), \\quad j = i\\end{cases}, \\quadA_{ij} = \\delta_{ij}\\] 若 \\(i\\%5 \\in \\{0, 4\\}\\ or\\ i/5 \\in \\{0, 4\\} :\\)\\[A_{ij} = \\delta_{ij}\\]import numpy as npimport copyimport scipy.linalgdef f(x,y): z=np.cos(3*x)*np.sin(np.pi*y) return -z#真解def zj(x,y): z=np.cos(3*x)*np.sin(np.pi*y)/(9+np.pi**2) return zn=int(input(&#39;n=&#39;))a,b=0,np.pic,d=0,1h1=(b-a)/nh2=(d-c)/nxdate=np.linspace(a,b,n+1)ydate=np.linspace(c,d,n+1)A=np.zeros([(n+1)**2,(n+1)**2])for i in range(n+1): if i==0: for j in range(n+1): A[j,j]=1 elif i==n: for j in range(n+1): A[n*(n+1)+j,n*(n+1)+j]=1 else: A[i*(n+1),i*(n+1)]=1 A[(i+1)*(n+1)-1,(i+1)*(n+1)-1]=1 for j in range(n+1)[1:-1]: A[i*(n+1)+j,i*(n+1)+j]=-2/h1**2-2/h2**2 A[i*(n+1)+j,i*(n+1)+j-1]=1/h2**2 A[i*(n+1)+j,i*(n+1)+j+1]=1/h2**2 A[i*(n+1)+j,(i-1)*(n+1)+j]=1/h1**2 A[i*(n+1)+j,(i+1)*(n+1)+j]=1/h1**2x_0,y_0=np.meshgrid(xdate[1:-1],ydate[1:-1])F=np.zeros([n+1,n+1])F[1:-1,1:-1]=f(x_0,y_0)F[:,0]=zj(0,ydate)F[:,-1]=zj(np.pi,ydate)F=F.TF=F.flatten()u=np.linalg.solve(A,F)u=u.reshape(n+1,n+1)x_1,y_1=np.meshgrid(xdate,ydate)kkk=zj(x_1,y_1)er=np.linalg.norm(u[1:-1,1:-1]-kkk.T[1:-1,1:-1],ord=1)/(n-1)**2err=abs(u[1:-1,1:-1]-kkk.T[1:-1,1:-1]).max()print(err)" }, { "title": "变分原理", "url": "/posts/variational-method/", "categories": "泛函分析", "tags": "泛函, 变分, 微分几何", "date": "2022-03-09 19:34:13 +0800", "snippet": "写在前面变分是非常强力的数学工具, 在计算数学中非常常见,冯康院士根据变分给出了有限元方法的数学原理, 开辟了有限元方法的研究,是近代中国数学的巨大创新.变分最早可以追溯到牛顿解最速下降曲线时使用,距今已经过去了好几百年, 我第一次见到 变分 这个词是在学有限元方法, 那时候只知道变分就是对函数求导, 但是 “对函数求导” 是什么意思? 这是我这两年半的研究生学习中最大的困惑, 这个神秘的 变分方法, 指引我学习基础的数学知识,直到今天, 学到的所有知识交汇在一起, 终于, 我悟到了变分的本质: 变分就是线性化 很简单的本质, 但是很多书上, 网上搜到的资料, 都没有讲这一点, 讲的都是关于 Euler-Lagrange 方程, 对此我很不满意, 这并不应该是变分的全部,这没有触及到变分的本质, 所以我就想讲一下我所理解的变分.本文将会从泛函分析和微分几何两个角度理解变分, 并将网上随处可以搜到的关于变分的知识结合,尽可能的讲述 变分.微分讲变分之前, 我先回顾一下数学分析中的微分.设函数 $f$ 为在 $x_0$ 周围有定义的函数, 若存在 $A \\in \\mathbb R$, 使得$$\\Delta f = f(x_0+\\Delta x) - f(x_0) = A \\Delta x + O(\\Delta x)$$则称 $f$ 在 $x_0$ 处可微, 微分为$$\\mathrm df = A\\mathrm dx$$特别的, 在梅加强版的数学分析中, 将 \\(x \\to Ax\\) 的线性映射称为 \\(f\\) 在 \\(x_0\\)处的微分.对于 \\(\\mathbb R^n\\) 中的函数 $f$ 可以类似定义:设函数 $f$ 为在 $\\boldsymbol x_0 \\in \\mathbb R^n$ 周围有定义的函数, 若存在 $A \\in \\mathbb R^n$, 使得$$\\Delta f = f(\\boldsymbol x_0+\\Delta \\boldsymbol x) - f(\\boldsymbol x_0) = A \\cdot \\Delta \\boldsymbol x + O(|\\Delta \\boldsymbol x|)$$则称 $f$ 在 $x_0$ 处可微, 微分为$$\\mathrm df = A\\cdot \\mathrm d\\boldsymbol x$$在梅加强版的数学分析中, 将 \\(\\boldsymbol x \\to A\\boldsymbol x\\) 的线性映射称为 \\(f\\) 在 \\(\\boldsymbol x_0\\) 处的微分.变分关于泛函, 我们在网上常见的定义是下面这样:令 $f \\in C^1(\\Omega\\times\\mathbb R\\times\\mathbb R^{n})$, 定义如下泛函:$$I(u) = \\int_{\\Omega} f(x, u(x), \\nabla u(x)) \\ \\mathrm dx$$泛函的变分是这样的:$\\forall \\phi \\in C^1_0(\\Omega)$, 可以定义 $I$ 关于 $\\phi$ 的变分:$$\\delta I(u_0, \\phi) = \\lim_{t \\to 0} \\frac{1}{t} (I(u_0+t\\phi) - I(u_0))$$结束, 这就是我们最经常接触到的关于变分的知识, 这样的定义可能对于工科,物理方面的学生很友好, 因为他们只需要会计算就行, 但是对于数学专业的学生来说,这样的定义非常糟糕, 别的不说, 就只问一点: 泛函的变分是什么? 在数学上,他是个什么东西? 这个定义根本没有回答这个问题! 这也是我最开始学变分时最大的困惑.要回答这一点, 我们还是要回到微分的定义, 从微分的定义出发看变分应该是个什么样子.正如前面所说: 我们希望 \\(f\\) 的微分存在, 需要存在一个 \\(A \\in R\\), 使得\\[\\Delta f(x_0) = f(x_0+\\Delta x) - f(x_0) = A \\Delta x + O(\\Delta x)\\]那类似的, 对于一个空间 \\(V\\) 上的泛函 \\(I\\) 我们可以直接这样写:\\[\\Delta I(u_0) = I(u_0 + \\Delta u) - I(u_0) = A \\Delta u + O(||\\Delta u||_{V})\\]那么问题来了, \\(A\\) 是什么? 是函数么? 很显然不是, 因为 \\(I(u_0 + \\Delta u) - I(u_0)\\) 是实数! 那么 \\(A\\Delta u\\) 也是实数, 所以思来想去, \\(A\\) 只能是一个泛函!,而且与前面微分的对比, \\(A\\) 还要是一个线性泛函, 定义在 \\(V\\) 上. 所以对于变分, 我们应该这样定义设 $I$ 为空间 $V$ 上的一个泛函, 若能找到一个线性映射 $A \\in V&#39;$, 使得:$$\\Delta I(u_0) = I(u_0 + \\Delta u) - I(u_0) = A \\Delta u + O(||\\Delta u||_{V})$$对于任意的 $\\Delta u \\in V$ 成立, 则称 $A$ 是 $I$ 的变分.既然说到这里了, 那我们再更进一步, \\(V\\) 上的泛函是 \\(V\\) 到 \\(\\mathbb R\\)上的映射, 那对于 \\(V\\) 到任意其他空间 \\(U\\) 上的的映射时不时也能类似的定义?当然可以!设 $U, V$ 是两个 Banach 空间, 对于一个映射 $F : U \\to V$ 若存在一个线性映射$A: U \\to V$ 满足: $$\\forall \\epsilon &amp;gt; 0, \\exists \\delta &amp;gt; 0$$ 使得$$||F(u) - F(u_0) - A(u - u_0)||_{V} \\leq \\epsilon ||u-u_0||_{U}$$对于任意的 $||u - u_0|| &amp;lt; \\delta$ 成立, 则称 $A$ 是 $F$ 的 Frechet 微分.迭代算法考虑问题:\\[\\mathcal L(u) = f\\]记 \\(\\mathcal L\\) 的变分为 \\(\\mathcal L_u\\), 任选 \\(u_0\\), 令 \\(\\delta u = u - u_0\\), 则有\\[\\mathcal L(u) = \\mathcal L(u_0+\\delta u) = \\mathcal L(u_0) + \\mathcal L_u(\\delta u) + O(||\\delta u||) = f\\]舍去高阶项后得到一个以 \\(\\delta u\\) 为为质量的线性问题:\\[\\mathcal L_u(\\delta u) = f - \\mathcal L(u_0)\\]令 \\(u_1 = u_0 + \\delta u\\), 得到一个迭代格式.微分几何的角度从微分几何的角度来看, 所有常见的函数空间 \\(V\\) 都是线性空间,线性空间中每个元素 \\(x\\) 处的切空间 \\(T_xV\\) 与 \\(V\\) 同构. 而 \\(V\\)上的一个泛函 \\(F\\) 就是 \\(V\\) 到 \\(R\\) 的一个映射, 其切映射 \\(DF_x\\) 是\\(T_xV\\) 到 \\(T_{F(x)}R\\) 的线性映射, 而:\\[T_xV = V, \\quad T_{F(x)}R = R\\]所以 \\(DF_x\\) 是 \\(V\\) 到 \\(R\\) 的线性映射, 所以 \\(DF_x \\in V&#39;\\), 不同的 \\(x \\in V\\) 有不同的切映射, 所以 \\(DF\\) 是一个 \\(V\\) 上的对偶矢量丛.而这个 \\(DF\\) 就是 \\(F\\) 的变分, 所以说泛函的变分是一个对偶矢量场,在每个函数处是一个线性泛函." }, { "title": "微分几何(一)：流形与张量场基础", "url": "/posts/differential_geometry_1/", "categories": "微分几何", "tags": "微分几何, 张量分析", "date": "2022-03-07 16:41:28 +0800", "snippet": "写在前面微分几何是非常非常有用的方向. 在我们本科期间学习数学分析后大概率会有以下的问题: 微分是什么? 作积分的时候有一个变量代换方法, 这个变量代换出来的雅可比矩阵是什么? 怎么来的? 积分与微分的关系? 第一类曲线积分, 第一类曲面积分, 第二类曲线积分,第二类曲面积分他们之间的关系是什么? 他们的定义到底是怎么定义的怎么来的?为什么这么定义?这些问题在数学分析中并没有讲清楚, 而微分几何就可以回答这些问题, 微分几何将本科学到的数学再度抽象,是从更高的姿态看待数学, 学习了微分几何会对数学有一个更全面更有高度的认识.本文是整理之前学习梁灿彬教授的《微分几何与广义相对论》时做的微分几何笔记, 第一部分 流形与张量场基础.微分流形拓扑空间是一个非常广泛非常常见的概念, 微分流形就是一个特殊的拓扑空间,关于拓扑空间的概念可以学习 “点集拓扑”. 首先给出微分流形的定义:若 $M$ 是一个拓扑空间, 存在一系列开集 $\\{O_{\\alpha}\\}_{\\alpha \\in A}$, 与这些开集上的映射 $\\{\\phi_{\\alpha}\\}_{\\alpha \\in A}$, 满足 $\\phi_{\\alpha} : O_{\\alpha} \\to V_{\\alpha}$ 是一个同胚映射, $V_{\\alpha}$ 是 $R^n$ 通常拓扑的开子集. 若 $O_{\\alpha} \\cup O_{\\beta} \\neq \\emptyset$, 则有: $\\phi_{\\alpha} \\phi_{\\beta}^{-1}$ 是 $C^{\\infty}$.则称 $M$ 是一个 $n$ 维微分流形.在拓扑空间上是没有坐标的, 但是在微分流形的定义中可以知道: 取 \\(p \\in O_{\\alpha}\\), \\(\\phi_{\\alpha}(p) \\in R^n\\), 所以我们可以定义 \\(\\phi_{\\alpha}(p)\\) 是 \\(p\\) 的局部坐标.若一个点存在多个开集中, 那他就有多个局部坐标, 其中 \\(\\phi_{\\alpha}\\phi_{\\beta}^{-1}\\) 可以认为是一个坐标变换函数, 所以简单来说, 微分流形就是有局部坐标, 且局部坐标变换函数是无穷光滑的拓扑空间微分流形上的满足定义中第一个条件的开集及其映射 $(O_{\\alpha}, \\phi_{\\alpha})$称为图, 若两个图满足第二个条件就说他们 相容,第二个条件被称为 相容性条件, 所有满足两个条件的图的集合被称为 图册图册中任意两个图相容.显然, 拓扑空间上可以定义不同的图册, 同理, 可以定义两个图册的相容性条件:两个图册中任意两个图相容. 那么对于两个图: 若两个图册相容, 那么他们可以合并成更大的图册, 所以有 极大图册 的概念,即: 所有与极大图册相容的图册都在极大图册中. 若两个不相容, 称他们定义的微分流形有 不同的微分结构.微分流形与拓扑空间的区别在于, 微分流行不仅有拓扑结构还有微分结构,所以在微分流形上不仅可以定义连续映射, 还可以定义可微映射.切矢和切矢场符号: 我们用 \\(\\mathscr T_{M}\\) 表示微分流形 \\(M\\) 上的全体函数.在 \\(R^n\\) 中矢量就是箭头, 就是一个方向. 现在要推广到微分流形上,就要搞清楚矢量的作用是什么. 在 \\(R^n\\) 中,矢量对于一个函数来说就是求函数在这个方向上的导数. 给一个函数,就能得到一个函数在这个方向的导数, 所以矢量可以认为是 \\(\\mathscr T_{M} \\to R\\)的映射. 好, 清除这一点我们就可以定义微分流形上的矢量的概念:映射 $v : \\mathscr T_{M} \\to R$ 被称微分流行上一点 $p$ 处的一个向量, 若其满足:- (线性) $v(af+bg) = av(f) + bv(g)$.- (莱布尼茨性) $v(fg) = f(p)v(g) + g(p)v(f)$.$v(0) = 0$; 若在 $p$ 的某个邻域内 $f1 = f2$, $v$ 是 $p$ 处的一个向量, 则 $v(f1) = v(f2)$ 略 向量长什么样子?在 \\(R^n\\) 中 \\(\\partial/\\partial x_i\\) 就是向量, 根据 \\(R^n\\) 的向量就可以定义一些\\(M\\) 上的向量. 若 \\(p \\in O_{\\alpha}\\), 局部坐标系是 \\(\\{a_1, a_2, \\cdots, a_n\\}\\), 在 \\(p\\) 的某个邻域内 \\(f(p) = F(a_1, a_2, \\cdots, a_n)\\), 定义:\\[X_i(f) = \\frac{\\partial F}{\\partial x_i}|_{(a_1, a_2, \\cdots, a_n)}\\]则 \\(X_i\\) 就是一个向量, 简记为: \\(\\partial/\\partial x_i\\). 微分流形上一点 $p$ 处所有向量组成一个线性空间 $V_p$, 且 $\\dim(V_p) = \\dim(M)$, 基矢就是 $\\{\\partial/\\partial x_i\\}_{i=1, 2, \\ldots, n}$.任取 \\(p\\) 点向量 \\(v\\) 存在 \\(v_i\\), 是\\(v = v_i \\{\\partial/\\partial x_i\\}\\). \\(v_i\\)称为是 \\(v\\) 的 分量.在不同的坐标系下有不同的分量, 他们之间有如下关系: ${x_i}, {x&#39;_i}$ 是两个局部坐标, $v$ 在 ${x_i}$ 下的分量为 $v_i$, 在 ${x_i}$ 下的分量为 $v&#39;_i$, 则有: $$ v&#39;_i = \\frac{\\partial x&#39;_i}{\\partial x_k}v_k $$下面定义微分流形上曲线的概念, 因为微分流形在局部是 \\(R^n\\),所以微分流形上的概念其实是 \\(R^n\\) 到微分流形的推广. \\(R\\) 也是一个微分流形, 所以\\(R\\) 到某个微分流形上可微映射也是良定义的.设 $I$ 是一个区间, 一个 $C^r$ 类映射 $C: I \\to M$ 称为是 $M$ 上的一条 $C^r$ 曲线.直观上来说, 微分流形 \\(M\\) 上的曲线应该是 \\(M\\) 的一个子集,而这里定义的曲线是一个映射, 这是因为存在不同的区间和映射使映射的像是这个曲线,现在只要映射不同就认为他们是不同的曲线, 并称他们是 ‘同一曲线’ 的不同参数化.在不同中找相同进行分类就是数学中常见的事, 下面定义两条曲线的一种关系: 重参数化.设 $C: I \\to M$, $C&#39; : I&#39; \\to M$ 若存在映射 $\\alpha : I \\to I&#39;$, 满足:- $C(t) = C&#39;(\\alpha (t))$.- $\\alpha&#39;(t)$ 处处非 0.则称 $C, C&#39;$ 重参数化." }, { "title": "导数算符", "url": "/posts/derivative_operateor/", "categories": "微分几何", "tags": "微分几何", "date": "2022-03-06 14:26:32 +0800", "snippet": "写在前面最近学习连续介质力学, 对之前一直不懂的导数算符有了一点新的理解,故记录下来以备复习, 希望看这篇文章的同学也能学到一点东西.新的理解简单来说就是:与度规相配的导数算符, 就是这个度规下, 标准正交基组成的坐标系的普通导数算符.导数算符流形 \\(M\\) 上的导数算符是一个 \\(\\mathscr T_{M}(l, m)\\) 到 \\(\\mathscr T_{M}(l, m+1)\\) 的映射, 满足以下 5 个性质: 具有线性性质; 满足莱布尼茨律; 与缩并可互换位置; \\(v(f) = v^a \\nabla_a f\\); 无挠性 : \\(\\nabla_a \\nabla_b f = \\nabla_b\\nabla_a f\\).可能大家看到这里有点蒙, 我对这里的定义的理解是, 流形上的导数算符可以认为是 欧氏空间 \\((\\mathbb R^3, \\delta_{ab})\\) 中求导符号的推广. 首先普通流形与 \\((\\mathbb R^3, \\delta_{ab})\\) 相比, 1. 没有定义度量; 2.没有定义坐标(坐标卡). 上面的 5 个条件就是在没有度量没有坐标系的情况下,我们常见的求导符号所剩下的特征.由定义可知, 不同导数算符作用在标量上是相同的, 但是作用在 \\(\\mathscr T_{M}(l, m)\\) 上就不同了其中 \\((l&amp;gt;0\\ or \\ m&amp;gt;0)\\). 但是有如下定理:Theorem.\\(\\nabla_a\\) 和 \\(\\tilde\\nabla_b\\) 是 \\(M\\) 上的两个导数算符, \\(w_b, w_b&#39;\\) 是两个对偶矢量场, 若 \\(w_b|_p = w_b&#39;|_p\\) 则有:\\[[(\\nabla_a - \\tilde\\nabla_a) w_b]_{p} = [(\\nabla_a - \\tilde\\nabla_a) w_b&#39;]_p\\]Proof. 略. #显然, \\((\\nabla_a - \\tilde\\nabla_a)\\) 是将 \\(p\\) 点处的一个对偶矢量映射成 \\(p\\)点处的一个 (0, 2) 型张量. 所以 \\((\\nabla_a - \\tilde\\nabla_a)\\) 对应于一个 (1, 2)型张量 \\(C_{ab}^c\\), 满足:\\[[(\\nabla_a - \\tilde\\nabla_a) w_b]_p = C^c_{ab} w_b|_p\\]事实上有如下定理,Theorem.\\[\\nabla_a T^{c_0 c_1 ... c_l}_{b_0 b_1 ... b_m} = \\tilde\\nabla_a T^{c_0 c_1 ... c_l}_{b_0 b_1 ... b_m}+ \\sum_{i} C_{ad}^{c_i} T^{c_0 c_1 ... d ... c_l}_{b_0 b_1 ... b_m}- \\sum_{j} C_{ab_j}^{d} T^{c_0 c_1 ... c_l}_{b_0 b_1 ... d ... b_m}\\]\\[\\forall T \\in \\mathscr T_{M}(l, m)\\]Proof. 略. #所以可以认为任意两个导数算符之间差一个 \\(C_{bc}^a\\). (\\(C_{bc}^a\\)有下标对称的性质, 这里就不展开表述了).普通导数算符设 \\({x^{\\mu}}\\) 是 \\(M\\) 上的坐标系, 坐标基矢场和为对偶坐标基矢场分别为 \\(\\{(\\partial x^{\\mu})^a\\}\\) 和 \\(\\{(\\mathrm dx^{\\mu})_a\\}\\), \\(O\\) 是坐标域, 则可以定义映射 \\(\\partial_a\\):\\[\\partial_a : \\mathscr T_{O}(k, l) \\to \\mathscr{T}_{O}(k, l+1)\\\\\\]\\[\\partial_a T_{c}^b := \\partial_{\\mu}T^{\\nu}_{\\sigma} (\\mathrm dx^{\\mu})_a (\\partial x^{\\nu})^b (\\mathrm dx^{\\sigma})_c\\]其中 \\(\\partial_{\\mu}T^{\\nu}_{\\sigma}\\) 表示 \\(T^{\\nu}_{\\sigma}\\) 的偏导.可以验证, 这个映射是一个导数算符, 称为坐标系 \\(\\{x^{\\mu}\\}\\) 的普通导数算符.克氏符Definition设 \\(\\partial_a\\) 是某一个坐标系的普通导数算符, 将导数算符 \\(\\nabla_a\\) 与\\(\\partial_a\\) 之差记为 \\(\\Gamma_{ab}^c\\), \\(\\Gamma_{ab}^c\\) 称为 \\(\\nabla_a\\)在该坐标下的克氏符.现在讨论这样一件事: 若 \\(\\{x^{\\mu}\\}\\) 和 \\(\\{x^{\\mu}_0\\}\\) 是 \\(M\\) 上的两个坐标系, 则两个坐标系的普通导数算符 \\(\\partial_a, \\partial_a^0\\) 之差是什么?记 \\(\\{(\\partial x^{\\mu})^a\\}\\) 和 \\(\\{(\\partial x^{\\mu}_0)^a\\}\\),分别是两个坐标的坐标基矢, 则存在一个矩阵 \\(A\\)(定义在 \\(M\\)上), 使得:\\[(\\partial x^{\\mu})^a = A_{\\mu\\nu} (\\partial x^{\\nu}_0)^a\\]则:\\[(\\mathrm dx^{\\mu})_a = A^{\\mu\\nu}(\\mathrm dx^{\\nu}_0)_a, \\quad\\frac{\\partial f}{\\partial x^{\\mu}} = A_{\\mu\\nu} \\frac{\\partial f}{\\partial x^{\\nu}_0}\\]若对偶向量 \\(w_a = w_{\\mu}(\\mathrm dx^{\\mu})_a = w_{\\nu}^0(\\mathrm dx^{\\nu}_0)_a\\), 则:\\[w_{\\mu} = A^{\\mu\\nu} w^0_{\\nu}\\]所以\\[\\begin{aligned}\\partial_a w_b &amp;amp; = \\partial_{\\mu}w_{\\nu} (\\mathrm dx^{\\nu})_b(\\mathrm dx^{\\mu})_a\\\\ \\partial_a^0 w_b &amp;amp; = \\partial_{\\mu}^0w_{\\nu}(\\mathrm dx^{\\nu}_0)_b(\\mathrm dx^{\\mu}_0)_a\\\\ &amp;amp; = \\frac{\\partial w_{\\nu&#39;}}{\\partial x^{\\mu&#39;}_0} A_{\\nu\\nu&#39;}(\\mathrm dx^{\\nu})_b A_{\\mu\\mu&#39;}(\\mathrm dx^{\\mu})_a\\\\ &amp;amp; = A^{\\mu\\mu&#39;}\\frac{\\partial w_{\\nu&#39;}}{\\partial x^{\\mu}} A_{\\nu\\nu&#39;}(\\mathrm dx^{\\nu})_b A_{\\mu\\mu&#39;}(\\mathrm dx^{\\mu})_a\\\\ &amp;amp; = A_{\\nu\\nu&#39;}\\partial_{\\mu} (A^{\\nu\\nu&#39;} w_{\\nu}) (\\mathrm dx^{\\nu})_b (\\mathrm dx^{\\mu})_a\\\\ &amp;amp; = A_{\\nu\\nu&#39;}\\partial_{\\mu} (A^{\\nu\\nu&#39;}) w_{\\nu} (\\mathrm dx^{\\nu})_b (\\mathrm dx^{\\mu})_a + \\partial_{\\mu}w_{\\nu} (\\mathrm dx^{\\nu})_b (\\mathrm dx^{\\mu})_a\\end{aligned}\\]记 \\(\\Gamma_{\\mu\\gamma}^{\\nu} = A_{\\nu\\gamma}\\partial_{\\mu} (A^{\\nu\\gamma})\\),是张量 \\(\\Gamma_{ab}^c\\) 的分量, 则:\\[\\Gamma_{ab}^{c} v_c = A_{\\nu\\gamma}\\partial_{\\mu} (A^{\\nu\\gamma}) v_{\\nu} (\\mathrm dx^{\\gamma})_b (\\mathrm dx^{\\mu})_a = (\\partial_a^0 - \\partial_a) v_b\\]" }, { "title": "连续介质力学(一)：张量分析基础", "url": "/posts/continuum_mechanics_1/", "categories": "连续介质力学", "tags": "连续介质力学, 微分几何, 张量分析", "date": "2022-03-04 22:19:01 +0800", "snippet": "写在前面连续介质力学 是理性力学的基础.连续介质力学中的数学部分是张量分析, 也是微分几何的基础, 之前学过梁灿彬教授的 《微分几何与广义相对论》中的微分几何部分,但是因为太过抽象, 理解的不够深刻, 这次学习的是《连续介质力学》这本书, 书中重点讲的是 \\(\\mathbb R^3\\) 中的微分几何, 像导数算符, 克氏符之前都是抽象的概念,现在终于找到了具体的对应, 解决了很多我以前的疑惑,本书的一的特点是, 基本上就把对偶向量当作了向量, 所以所有的 \\((l, m)\\) 型张量都被当成了 \\((l+m, 0)\\) 型张量, 他们的基都是\\[\\mathrm d\\boldsymbol e_{i_0} \\otimes\\mathrm d\\boldsymbol e_{i_1} \\otimes\\dots\\otimes\\mathrm d\\boldsymbol e_{i_{l+m-1}} , \\quad i_0, i_1, \\dots, i_{l+m-1} \\in \\{0, 1, 2\\}\\]1. Kronecker 符号, Levi-Civita 符号设 \\(\\boldsymbol{\\{e_0, e_1, e_2\\}}\\) 为 \\(\\mathbb R^3\\) 中一组标准正交基, 则有:\\[\\boldsymbol{e_i \\cdot e_j} = \\delta_{ij}, \\quad \\boldsymbol{e_i \\times e_j} = \\in_{ijk} \\boldsymbol{e_k}\\]其中 \\(\\delta_{ij}\\) 是 Kronecker 符号, \\(\\in_{ijk}\\) 是 Levi-Civita 符号:\\[\\delta_{ij} = \\begin{cases}1 \\quad i = j\\\\0 \\quad i \\neq j \\end{cases}, \\quad\\in_{ijk} = \\begin{cases}1 \\quad \\quad i, j, k \\text{是偶排列}\\\\-1 \\ \\quad i, j, k \\text{是奇排列}\\\\0 \\quad \\quad i, j, k \\text{有重复指标}\\\\\\end{cases}\\]Levi-Civita 符号满足下面恒等式:\\[\\in_{ijk}\\in_{lmn} = \\left| \\begin{matrix}\\delta_{il} &amp;amp; \\delta_{im} &amp;amp; \\delta_{in}\\\\\\delta_{jl} &amp;amp; \\delta_{jm} &amp;amp; \\delta_{jn}\\\\\\delta_{kl} &amp;amp; \\delta_{km} &amp;amp; \\delta_{kn}\\\\\\end{matrix} \\right|\\]2. 赝标量, 赝矢量首先引入两种坐标变换 镜面反射: 关于 \\(\\boldsymbol{e_y, e_z}\\) 所在平面的镜面反射:\\[\\boldsymbol{e}&#39;_x = -\\boldsymbol{e}_x,\\quad \\boldsymbol{e}&#39;_y = \\boldsymbol{e}_y,\\quad \\boldsymbol{e}&#39;_z = \\boldsymbol{e}_z.\\] 反演变换:\\[\\boldsymbol{e}&#39;_x = -\\boldsymbol{e}_x,\\quad \\boldsymbol{e}&#39;_y = -\\boldsymbol{e}_y,\\quad \\boldsymbol{e}&#39;_z = -\\boldsymbol{e}_z.\\]在空间反演下改变方向的是 真矢量, 否则是 赝矢量.两个真矢量的叉乘是赝矢量.事实上在微分几何中, 令 \\(V = \\mathbb E^3\\), 真矢量对应于 \\(\\Lambda V\\) 中的元素, 赝矢量对应于 \\(\\Lambda^2 V\\) 中的元素.可以认为真矢量的基为 \\(\\boldsymbol e_0, \\boldsymbol e_1, \\boldsymbole_2\\), 真标量的基为 \\(1\\), 而赝矢量的基为 \\(\\boldsymbol e_1 \\times \\boldsymbol e_2, \\boldsymbol e_2 \\times \\boldsymbol e_0, \\boldsymbol e_0 \\times \\boldsymbol e_1\\), 赝标量的基为 \\(\\boldsymbol e_0\\cdot (\\boldsymbol e_1 \\times \\boldsymbol e_2)\\)令\\(\\boldsymbol u = u_i \\boldsymbol e_i, \\boldsymbol v = v_i \\boldsymbol e_i\\)则\\[\\begin{aligned}\\boldsymbol u \\times \\boldsymbol v &amp;amp; = u_i \\boldsymbol e_i \\times v_j \\boldsymbol e_j\\\\&amp;amp; = (u_0 v_1 - v_0 u_1)\\boldsymbol e_0 \\times \\boldsymbol e_1 + (u_1 v_2 - v_2 u_1)\\boldsymbol e_1 \\times \\boldsymbol e_2 + (u_2 v_0 - v_0 u_2)\\boldsymbol e_2 \\times \\boldsymbol e_0\\end{aligned}\\]令 \\(\\boldsymbol e_i&#39; = -\\boldsymbol e_i\\), 则: \\(\\boldsymbol u = -u_i \\boldsymbol e_i&#39;, \\boldsymbol v = -v_i \\boldsymbol e_i&#39;\\)\\[\\begin{aligned}\\boldsymbol u \\times \\boldsymbol v &amp;amp; = (-u_i) \\boldsymbol e_i&#39; \\times (-v_j) \\boldsymbol e_j&#39;\\\\&amp;amp; = (u_0 v_1 - v_0 u_1)\\boldsymbol e_0&#39; \\times \\boldsymbol e_1&#39; + (u_1 v_2 - v_2 u_1)\\boldsymbol e_1&#39; \\times \\boldsymbol e_2&#39; + (u_2 v_0 - v_0 u_2)\\boldsymbol e_2&#39; \\times \\boldsymbol e_0&#39;\\\\&amp;amp; = (u_0 v_1 - v_0 u_1)\\boldsymbol e_0 \\times \\boldsymbol e_1 + (u_1 v_2 - v_2 u_1)\\boldsymbol e_1 \\times \\boldsymbol e_2 + (u_2 v_0 - v_0 u_2)\\boldsymbol e_2 \\times \\boldsymbol e_0\\end{aligned}\\]3. 逆变矢量, 协变矢量对于一个线性空间 \\(V\\), 其上的所有线性泛函组成其 对偶空间(共轭空间) \\(V^*\\). 逆变矢量就是 \\(V\\) 中的元素, 协变矢量就是 \\(V&#39;\\) 中的元素.设 \\(\\boldsymbol{\\{e_0, e_1, e_2\\}}\\) 为 \\(\\mathbb R^3\\) 中一组基(逆变基), 取\\(\\boldsymbol{e^0, e^1, e^2} \\in (\\mathbb R^3)&#39;\\) 满足:\\[\\boldsymbol{e^i(e_j)} = \\delta_{ij}\\]则 \\(\\boldsymbol{e^0, e^1, e^2}\\) 是 \\((\\mathbb R^3)&#39;\\) 中的一组基(协变基). 当 \\(V\\)上定义了度规以后, 根据 里斯表示定理, 存在 \\(\\boldsymbol{e^{0*}, e^{1*}, e^{2*}} \\in (\\mathbb R^3)\\) 与 \\(\\boldsymbol{e^0, e^1, e^2}\\) 对应.(逆变基在 \\(V\\) 中的表示)4.度规张量前面讲的东西其实是有一些问题的:为什么有标准正交基? 因为有向量内积? 那为什么有向量内积? \\(\\mathbb E^3\\)上天然有内积么? 不是的, 这是需要定义的, 即定义一个双线型泛函\\[A : \\mathbb E^3 \\times \\mathbb E^3 \\to \\mathbb R\\]满足 3 个条件(内积的 3 个条件, 省略)而度规张量就是内积的另一个名字. 内积的定义一般为:\\[(u, v) = u \\cdot v\\]而若 \\(A\\) 是一个正定矩阵\\[(u, v) = uAv = u_i A^{ij}v_i\\]也是一个内积, 而其中 \\(A^{ij}\\) 就是一个度规张量.5. 克氏符略6. 哈密尔顿-凯莱定理考虑一个 \\(2\\) 阶张量 \\(\\boldsymbol S\\), 一个矢量 \\(\\boldsymbol v\\) 可以成为\\(\\boldsymbol S\\) 的特征向量当:\\[\\boldsymbol {Sv} = \\lambda \\boldsymbol v\\]其中 \\(\\lambda\\) 是 \\(\\boldsymbol S\\) 的特征值. \\(\\lambda\\) 是 \\(\\boldsymbol S\\) 的特征值存在的充要条件是:\\[\\mathrm{det}(\\boldsymbol{S} - \\lambda \\boldsymbol I) = 0\\]记\\[I_1 = \\mathrm{tr}\\boldsymbol S, \\quad I_2 = \\frac{1}{2}[(\\mathrm{tr}\\boldsymbol S)^2 - \\mathrm{tr}S^2], \\quadI_3 = \\mathrm{det} \\boldsymbol S\\]则:\\[\\mathrm{det}(\\boldsymbol{S} - \\lambda \\boldsymbol I) = \\lambda^3 - I_1\\lambda^2+ I_2\\lambda -I_3\\]哈密尔顿-凯莱定理: 任何一个 $(n\\times n)$ 的矩阵都满足其特征方程.7. 二阶张量的微积分对于标量场 \\(\\phi\\), 定义其左右梯度如下:\\[\\nabla\\otimes \\phi = \\frac{\\partial \\phi}{\\partial x_i} \\boldsymbol e_i, \\quad\\phi \\otimes \\nabla = \\frac{\\partial \\phi}{\\partial x_i} \\boldsymbol e_i.\\]对于向量场 \\(\\boldsymbol v\\), 定义其左右梯度如下:\\[\\nabla\\otimes \\boldsymbol v = \\frac{\\partial v_j}{\\partial x_i} \\boldsymbol e_i \\otimes \\boldsymbol e_j, \\quad\\nabla\\otimes \\boldsymbol v = \\frac{\\partial v_i}{\\partial x_j} \\boldsymbol e_i \\otimes \\boldsymbol e_j\\]对于二阶张量场 \\(\\boldsymbol T\\), 定义其左右梯度如下:\\[\\nabla\\otimes \\boldsymbol T = \\frac{\\partial T_{jk}}{\\partial x_i} \\boldsymbol e_i \\otimes \\boldsymbol e_j\\otimes \\boldsymbol e_k, \\quad\\nabla\\otimes \\boldsymbol T = \\frac{\\partial T_{ij}}{\\partial x_k} \\boldsymbol e_i \\otimes \\boldsymbol e_j\\otimes \\boldsymbol e_k\\]" }, { "title": "第一句话 + 基于 Github Page 的个人网页构建", "url": "/posts/first-word/", "categories": "计算机", "tags": "网站搭建", "date": "2022-03-02 22:19:00 +0800", "snippet": "写在前面这两天在网上冲浪时发现一个和我同年的大佬怪使, 同样是 19 级的硕士, 但是他拥有一个内容丰富, 有大量数学, 计算机干货的个人网站, 博客内容从机器学习算法到数学建模, 再到泛函里的广义函数空间, 内容即有广度又有深度, 这让我自惭形秽,同样是学数学的, 差距咋就这么大呢?反思之后决定也要做一个个人博客写自己在学数学, 学计算机过程中的思考, 开冲!个人网站的选择第一次建立个人网站, 没有经验, 在浏览器上搜了半天,获取了一点点关于网站的信息(不知对错就暂时这么写着, 以后有更深刻理解了再改):网站分为静态网站和动态网站, 其中动态网站需要买域名, 租服务器, 需要一点点钱, 所以暂时不适合我这个学生. 而静态网站可以由 github, gitlab,gitee 等平台构建, 简单方便, 有基本的功能, 而且免费, 所以我就先构建一个静态网站.因为之前在老师的网站上写过东西, 对 jekyll 稍微微有一点点了解, 所以我选择了 github + jekyll 构建个人网站.材料准备 一个 github 的账号; 在 jekyll theme 下载一个喜欢的主题. 我选择的是Chirpy 这一款; 了解 makedown 文件编写; 安装 jekyll.个人网站构建 在 github 上点击 New 新建仓库, 名字设值为 name.github.io 其中 name换成自己的 github 名称. 把仓库 clone 下来, 然后把下载的主题文件夹中的所有文件复制到仓库中,然后上传上去. 在 github 上进入仓库, 点击 setting-&amp;gt;General-&amp;gt;page 然后在 source设置下面设置分支为 gh-pages root, 然后点 save 保存.然后等 3 分钟网站就构建好啦! 在浏览器上进入 name.github.io就进入自己的网站啦! 但是现在网站中只有 jekyll 主题的基本信息,接下来就需要在网站中添加内容啦.发布内容以下是我基于 Chirpy 主题的操作方式, 其他的主题类似, 可能也有些许不同,需要自己去主题的 github 仓库去找使用手册.在本地进入自己的仓库, 里面有一个 _post 文件夹, 在文件夹中添加 markdown文件就可以了.在 markdown 文件头部可以添加作者, 时间, 文件的标签, 类别等信息,如果有数学公式需要加一行math: true写完文件以后上传到网站等 3 分钟就能在自己的网站上看到自己的博客啦!但是每次写完上传才能看到网页效果, 有点麻烦, 所以需要用 jekyll 进行预览网页本地预览jekyll 的安装网上都有, 我就不赘述了, 直接讲怎么进行本地预览.在第一次预览时需要在仓库下运行bundle预览是执行jekyll serve然后在浏览器打开 http://127.0.0.1:4000/ 就可以进行效果预览.结束语24 年的经验告诉我, 我不是一个会写作, 爱写作的人,希望这个个人网站能让我提起对写作的兴趣, 并提高我的写作能力,更进一步提高我的表达能力, 加油! 冲冲冲!" } ]
